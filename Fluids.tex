\documentclass[10pt]{article}
\usepackage[letterpaper]{geometry}
\geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
\usepackage{setspace}
\usepackage{ragged2e}
\usepackage{color}
\usepackage{titlesec}
\usepackage{graphicx}
\usepackage{float}
\usepackage{mathtools}
\usepackage{amsmath}
\usepackage[font=small,labelfont=bf,labelsep=period]{caption}
\usepackage[english]{babel}
\usepackage{indentfirst}
\usepackage{array}
\usepackage{makecell}
\usepackage[usenames,dvipsnames]{xcolor}
\usepackage{multirow}
\usepackage{tabularx}
\usepackage{arydshln}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{xfrac}
\usepackage{etoolbox}
\usepackage{cite}
\usepackage{url}
\usepackage{dcolumn}
\usepackage{hyperref}
\usepackage{courier}
\usepackage{url}
\usepackage{esvect}
\usepackage{commath}
\usepackage{verbatim} % for block comments
\usepackage{enumitem}
\usepackage{hyperref} % for clickable table of contents
\usepackage{braket}
\usepackage{titlesec}
\usepackage{booktabs}
\usepackage{gensymb}
\usepackage{longtable}
\usepackage{soul} % for striking out text
\usepackage{tcolorbox} % for colored boxes
\tcbuselibrary{breakable} % to allow colored boxed to extend over multiple pages
\usepackage[makeroom]{cancel}	% to cancel out text
\usepackage{breqn}
\usepackage[mathscr]{euscript}
\usepackage{listings}
\lstset{
	basicstyle=\ttfamily\small,
    frame=single,
    breaklines=true,
    commentstyle=\color{magenta}\ttfamily,
    postbreak=\raisebox{0ex}[0ex][0ex]{\ensuremath{\color{red}\hookrightarrow\space}}
}

% new commands for shorter writing of equations
\newcommand{\beq}{\begin{equation}}
\newcommand{\eeq}{\end{equation}}
\newcommand{\beqa}{\begin{equation}\begin{aligned}}
\newcommand{\eeqa}{\end{aligned}\end{equation}}
\newcommand{\la}{\langle}
\newcommand{\ra}{\rangle}

\titleclass{\subsubsubsection}{straight}[\subsection]

% define new command for triple sub sections
\newcounter{subsubsubsection}[subsubsection]
\renewcommand\thesubsubsubsection{\thesubsubsection.\arabic{subsubsubsection}}
\renewcommand\theparagraph{\thesubsubsubsection.\arabic{paragraph}} % optional; useful if paragraphs are to be numbered

\titleformat{\subsubsubsection}
  {\normalfont\normalsize\bfseries}{\thesubsubsubsection}{1em}{}
\titlespacing*{\subsubsubsection}
{0pt}{3.25ex plus 1ex minus .2ex}{1.5ex plus .2ex}

\makeatletter
\renewcommand\paragraph{\@startsection{paragraph}{5}{\z@}%
  {3.25ex \@plus1ex \@minus.2ex}%
  {-1em}%
  {\normalfont\normalsize\bfseries}}
\renewcommand\subparagraph{\@startsection{subparagraph}{6}{\parindent}%
  {3.25ex \@plus1ex \@minus .2ex}%
  {-1em}%
  {\normalfont\normalsize\bfseries}}
\def\toclevel@subsubsubsection{4}
\def\toclevel@paragraph{5}
\def\toclevel@paragraph{6}
\def\l@subsubsubsection{\@dottedtocline{4}{7em}{4em}}
\def\l@paragraph{\@dottedtocline{5}{10em}{5em}}
\def\l@subparagraph{\@dottedtocline{6}{14em}{6em}}
\makeatother

\newcommand{\volume}{\mathop{\ooalign{\hfil$V$\hfil\cr\kern0.08em--\hfil\cr}}\nolimits}

\setcounter{secnumdepth}{4}
\setcounter{tocdepth}{4}

\begin{document}

\begin{centering}
\large Fluid Dynamics\\
\end{centering}

\tableofcontents
\clearpage

\section{Introduction}
\begin{flushleft}\justify

This document contains information regarding the theory and modeling of fluids that is outside the scope of the Pronghorn theory manual, but is useful for obtaining a deeper understanding of the fluid flow equations. To avoid repetition, refer to the Pronghorn theory manual for the detailed derivations of the Navier-Stokes equations and definitions of all of the notation used in this document.

\section{The Euler Equations}

The Navier-Stokes equations are five tightly coupled equations for the components of velocity and two thermodynamic quantities. There is some flexibility in which thermodynamic quantities can be the solution variables, which gives rise to many different, but mathematically equivalent, forms of the equations. 

By conservation of mass, the Euler equations can equivalently be written in non-conservative form as:

\beq
\frac{\partial\vv{\mathscr{U}}}{\partial t}+\vv{V}\cdot\frac{\partial\vv{\mathscr{U}}_i}{\partial x_i}+\frac{1}{\rho}\vv{\mathscr{S}}=0
\eeq

where \(\vv{\mathscr{U}}\) is a vector of primitive solution variables and \(\vv{\mathscr{S}}\) represents the remaining terms. These vectors are defined as:

\beq
\vv{\mathscr{U}}=\begin{bmatrix}\rho\\ V_1\\V_2\\V_3\\H\end{bmatrix}
\eeq

\beq
\vv{\mathscr{S}}=\begin{bmatrix}\rho^2\frac{\partial V_i}{\partial x_i}\\\frac{\partial P}{\partial x_1}\\\frac{\partial P}{\partial x_2}\\\frac{\partial P}{\partial x_3}\\\frac{\partial P}{\partial t}\end{bmatrix}
\eeq

When the \(i\)-th component of \(\vv{\mathscr{S}}\) is zero, then in steady-state (such that the \(\partial\vv{\mathscr{U}}/\partial t\) term is absent), the \(i\)-th component of \(\vv{\mathscr{U}}\) must be constant along streamlines. When the \(i\)-th component of \(\vv{\mathscr{U}}\) is constant along streamlines, then because all streamlines originate from the inlet boundaries, provided uniform inflow conditions exist, then the \(i\)-th component of \(\vv{\mathscr{U}}\) is uniform throughout the entire flow field. For the mass, momentum, and energy equations, we therefore have three possible scenarios:

\begin{enumerate}
\item Mass equation - if \(\rho^2\frac{\partial V_i}{\partial x_i}=0\), this implies that the flow is incompressible, and regardless of steady-state or transient flows, \(\rho\) is constant everywhere in the flow field.
\item Momentum equations - if \(P\) is constant in the \(i\)-th coordinate direction, then in steady-state, the \(i\)-th component of velocity is constant along streamlines.
\item Energy equation - if \(\partial P/\partial t=0\), in general the flow must be steady-state, in which case \(H\) is constant along streamlines. 
\end{enumerate}

Simulation results for very low viscous surface friction compare well with zero viscous friction, suggesting that the Euler equations satisfy the limit of the Navier-Stokes equations as the viscosity tends to zero \cite{hoffman}.  

If a steady-state flow is characterized by uniform inlet conditions such that \(H\) and \(s\) are constant everywhere in the flow field, then Eq. \eqref{eq:MomentumEqn}b shows that the entire flow must be irrotational. But, an even more general vorticity observation comes from inviscid theory - vorticity is constant in any streamtube. This can be reasoned by consideration of the forces acting on a fluid particle. With the Euler equations, all forces either act from the center of mass (gravity, if not neglected) or normal to the fluid particle (pressure), and none can cause rotation. So, all streamlines emanating from an irrotational region will remain irrotational. So, provided inflow conditions are uniform, then the entire domain is irrotational. Viscous flows typically remain nearly irrotational outside of boundary layers.

\section{Equivalent Forms and Simplifications of the Navier-Stokes Equations}

Several equivalent equations exist to describe the same phenomena as the Navier-Stokes equations - these forms are discussed in this section. The Navier-Stokes equation is repeated here for reference:

\begin{equation*}
\frac{\partial\vv{V}}{\partial t}+\vv{V}\cdot\nabla\vv{V}+\frac{1}{\rho}\nabla P-\vv{g}-\frac{1}{\rho}\nabla\cdot\tau=0
\end{equation*}

Several equivalent forms of the Navier-Stokes momentum equation are now derived through manipulations of mechanical and thermodynamic relations. First, we will rewrite the advective term by using the definitions of \(e_{ij}\) and \(\xi_{ij}\) and then taking the scalar product with velocity:

\begin{subequations}
\label{eq:FluidsIdentity}
\begin{eqnarray}
\frac{\partial V_i}{\partial x_j}&=&\frac{1}{2}\left(\frac{\partial V_i}{\partial x_j}+\frac{\partial V_j}{\partial x_i}\right)-\frac{1}{2}\varepsilon_{ijk}\omega_k\\
V_j\frac{\partial V_i}{\partial x_j}&=&\ V_j\frac{\partial V_j}{\partial x_i}-\varepsilon_{ijk}V_j\omega_k\\
V_j\frac{\partial V_i}{\partial x_j}&=&\ \nabla\left(\frac{1}{2}V^2\right)+(\vv{\omega}\times\vv{V})
\end{eqnarray}
\end{subequations}

Using the above relationship in the Navier-Stokes equations gives:

\beq
\label{eq:EquivalenttoEulera}
\frac{\partial \vv{V}}{\partial t}+\nabla\left(\frac{1}{2}V^2\right)+\frac{1}{\rho}\nabla P-\vv{g}-(\vv{V}\times\vv{\omega})-\frac{1}{\rho}\nabla\cdot\tau=0
\eeq

A second equivalent form can be derived by modifying the Gibbs identity to be a differential with respect to \(e+P\nu\). Then, inserting the definition of enthalpy and transforming the exact differential to a spatial differential:

\begin{subequations}
\label{eq:EnthalpyEqn}
\begin{eqnarray}
d(e+P\nu)&=&Tds-\cancel{Pd\nu}+\cancel{Pd\nu}+\nu dP\\
\nabla h&=&T\nabla s+\frac{\nabla P}{\rho}
\end{eqnarray}
\end{subequations}

Using the above equation in Eq. \eqref{eq:EquivalenttoEulera} gives a second equivalent form:

\beq
\label{eq:EquivalenttoEulerb}
\frac{\partial \vv{V}}{\partial t}+\nabla\left(\frac{1}{2}V^2+h\right)-T\nabla s-\vv{g}-(\vv{V}\times\vv{\omega})-\frac{1}{\rho}\nabla\cdot\tau=0
\eeq

Gravity can also be moved inside the gradient if we assume that \(\vv{g}=-g\vv{e}_z\) such that \(\nabla(gz)=g\vv{e}_z\):

\beq
\label{eq:EquivalenttoEulerc}
\frac{\partial \vv{V}}{\partial t}+\nabla\left(\frac{1}{2}V^2+h+gz\right)-T\nabla s-(\vv{V}\times\vv{\omega})-\frac{1}{\rho}\nabla\cdot\tau=0
\eeq

When viscous effects are neglected, Eq. \eqref{eq:EquivalenttoEulerc} is known as the Crocco-Vazsonyi equation. This equation reveals several important properties about fluid flows - first, the flow will be rotational (nonzero vorticity) in a stationary reference frame even in steady flows unless the flow is isentropic, frictionless, and isoenergetic (sum of kinetic energy per unit mass, enthalpy, and gravitational potential are constant along a streamline).

\subsection{The Bernoulli Equation}
The minimum number of assumptions that can be made to Eq. \ref{eq:EquivalenttoEulerc} to obtain the Bernoulli equation is to assume 1) steady, 2) inviscid, 3) isentropic, and 4) irrotational flow. These assumptions apply {\it anywhere} in the flow field.

\beq
\label{eq:Bernoulli1}
\underbrace{\cancel{\frac{\partial \vv{V}}{\partial t}}}_{\textrm{steady}}+\nabla\left(\frac{1}{2}V^2+h+gz\right)=\underbrace{T\cancel{\nabla s}}_{\text{isentropic}}+\underbrace{(\vv{V}\times\cancel{\vv{\omega})}}_{\text{irrotational}}+\underbrace{\cancel{\mu\nabla^2\vv{V}}}_{\text{inviscid}}
\eeq

Alternatively, take the scalar product of Eq. \ref{eq:EquivalenttoEulerc} with velocity to obtain a form that only applies along a streamline. Then, by assuming 1) steady, 2) inviscid, and 3) isentropic flow 4) along a streamline, a form equivalent to the form above is obtained that only applies along streamlines, but does not require irrotational flow.

\beq
\label{eq:Bernoulli2}
\underbrace{\cancel{\vv{V}\cdot\frac{\partial \vv{V}}{\partial t}}}_{\text{steady}}+\vv{V}\cdot\nabla\left(\frac{1}{2}V^2+h+gz\right)=\underbrace{\vv{V}\cdot T\cancel{\nabla s}}_{\text{isentropic}}+\underbrace{\cancel{\vv{V}\cdot(\vv{V}\times\vv{\omega})}}_{\text{definition}}+\underbrace{\vv{V}\cdot(\cancel{\mu\nabla^2\vv{V})}}_{\text{inviscid}}
\eeq

Then, if the flow is assumed incompressible, for \(e=e(\rho,s)\), \(e\) will be constant, as isentropic flow is already assumed. Then, both of the forms above would reduce to:

\beq
\label{eq:Bernoulli3}
\nabla\left(\frac{1}{2}V^2+\frac{P}{\rho}+gz\right)=0
\eeq

\subsection{The Vorticity Equation}

While the Crocco-Vazsonyi equation is one equivalent form of the momentum equation that contains vorticity, the momentum equation can be entirely cast in terms of vorticity by taking the curl of the momentum equation. Taking the curl of the momentum equation gives:

\beq
\label{eq:Equiv4}
\nabla\times\left(\frac{\partial \vv{V}}{\partial t}+\vv{V}\cdot\nabla\vv{V}\right)=-\nabla\times\frac{\nabla P}{\rho}+\nabla\times\left(\frac{\nabla\cdot\tau}{\rho}\right)
\eeq

where gravity is assumed to be a conservative vector field, and hence cancels since the curl of a conservative vector field is zero. Now, several vector calculus identities are introduced that will be useful in identifying several equivalent manipulations of Eq. \eqref{eq:Equiv4}. These identities are as follows:

\beq
\label{eq:VectorCalculusIdentityCrossProduct}
\nabla\times\frac{\nabla P}{\rho}=-\frac{\nabla\rho\times\nabla P}{\rho^2}
\eeq

\beq
\label{eq:VorticityIdentity}
\nabla\times(\vv{\omega}\times\vv{V})=\vv{\omega}(\nabla\cdot\vv{V})+(\vv{V}\cdot\nabla)\vv{\omega}-(\vv{\omega}\cdot\nabla)\vv{V}
\eeq

\beq
\nabla\times(\nabla\times\vv{\omega})=-\nabla^2\vv{\omega}
\eeq

where \(\nabla\times\nabla P\) must equal zero due to vector calculus properties and \(\nabla\cdot\vv{\omega}=0\) by definition in Eq. \eqref{eq:VorticityIdentity}. In addition to the above three identities, Eq. \eqref{eq:VorticityIdentity1} will be used. 

Now, several equivalent forms of the vorticity equation are derived using a variety of identities that are either derived in the Pronghorn theory manual or in this document. All of these equivalent forms are represented in Eq. \eqref{eq:VorticityEquation}. Inserting Eq. \eqref{eq:VectorCalculusIdentityCrossProduct} into Eq. \eqref{eq:Equiv4} gives Eq. \eqref{eq:VorticityEquation}a. Then, the velocity on the left-hand-side of Eq. \eqref{eq:VorticityEquation}a can be transformed into vorticity by using 1) the fact that because a gradient is a spatial derivative, the curl can be brought inside the time derivative, and 2) the identity in Eq. \eqref{eq:VorticityIdentity1}; these transformations give Eq. \eqref{eq:VorticityEquation}b. Eq. \eqref{eq:VorticityEquation}c can be obtained using the continuity equation and the vector identity in Eq. \eqref{eq:VorticityIdentity}. Eq. \eqref{eq:VorticityEquation}d is obtained by multiplying Eq. \eqref{eq:VorticityEquation}c by \(1/\rho\) and grouping terms.

\begin{subequations}
\label{eq:VorticityEquation}
\begin{eqnarray}
\nabla\times\left(\frac{\partial \vv{V}}{\partial t}+\vv{V}\cdot\nabla\vv{V}\right)&=&\frac{\nabla\rho\times\nabla P}{\rho^2}+\nabla\times\left(\frac{\nabla\cdot\tau}{\rho}\right)\\
\frac{\partial\vv{\omega}}{\partial t}+\nabla\times(\vv{\omega}\times\vv{V})&=&\frac{\nabla\rho\times\nabla P}{\rho^2}+\nabla\times\left(\frac{\nabla\cdot\tau}{\rho}\right)\\
\frac{d\vv{\omega}}{dt}+\vv{\omega}\left(-\frac{1}{\rho}\frac{d\rho}{dt}\right)-\vv{\omega}\cdot\nabla\vv{V}&=&\frac{\nabla\rho\times\nabla P}{\rho^2}+\nabla\times\left(\frac{\nabla\cdot\tau}{\rho}\right)\\
\frac{d}{dt}\left(\frac{\vv{\omega}}{\rho}\right)-\frac{\vv{\omega}}{\rho}\cdot\nabla\vv{V}&=&\frac{1}{\rho}\frac{\nabla\rho\times\nabla P}{\rho^2}+\frac{1}{\rho}\nabla\times\left(\frac{\nabla\cdot\tau}{\rho}\right)
\end{eqnarray}
\end{subequations}

For incompressible flow, \(\tau=\mu\nabla\vv{V}\); assuming constant viscosity, the viscous shear stress term that appears in each of the vorticity equations in Eq. \eqref{eq:VorticityEquation} can be replaced by:

\beqa
\label{eq:ViscousReplacement}
\nabla\times\left(\frac{\nabla\cdot\tau}{\rho}\right)\rightarrow&\ \nabla\times(\nu\nabla^2\vv{V})\\
=&\ \nu\nabla^2\vv{\omega}\\
=&\ -\nu\nabla\times(\nabla\times\vv{\omega})
\eeqa

If density is assumed to be a function of pressure and temperature, then \(\nabla\rho\times\nabla P\) will allow some terms to cancel, giving a simpler vorticity equation. By expressing the spatial gradient of density through a chain rule in terms of the spatial gradients of pressure and temperature, and introducing definitions for the compressibility and thermal expansion, density is of the form:

\beq
\label{eq:DensityPT}
\nabla\rho=\rho\alpha_T\nabla P-\beta\rho\nabla T
\eeq

Inserting Eq. \eqref{eq:DensityPT} into the first term on the right hand side of Eq. \eqref{eq:VorticityEquation} gives:

\beq
\label{eq:DensitySubstitution}
\frac{\nabla\rho\times\nabla P}{\rho^2}\rightarrow -\frac{\beta\rho\nabla T\times\nabla P}{\rho^2}
\eeq

Further, if the flow is barotropic (density is only a function of pressure), then the \(\beta\) term in Eq. \eqref{eq:DensityPT} is zero, causing Eq. \eqref{eq:DensitySubstitution} to be zero. A flow can be barotropic if the flow is incompressible, isothermal, or isentropic. 

\subsection{Potential Flow}
Because potential flows assume isentropic flows, density can be expressed entirely as a function of velocity. To rewrite the above equation, use Eq. \eqref{eq:EnthalpyEqn}, simplified for isentropic flows:

\beqa
dh=&\frac{dP}{\rho}\\
=&c^2\frac{d\rho}{\rho}
\eeqa

Neglecting gravitational forces, Eq. \eqref{eq:EnergyEqnPotential}a can be written as:

\begin{subequations}
\label{eq:R1}
\begin{eqnarray}
\frac{\partial (\nabla\phi)}{\partial t}+\nabla \left(\frac{1}{2}V^2\right)+\nabla h&=&0\\
\frac{\partial (\nabla\phi)}{\partial t}+\nabla \left(\frac{1}{2}(\nabla\phi)^2\right)+\frac{c^2}{\rho}\nabla\rho&=&0
\end{eqnarray}
\end{subequations}

The above can also be written equivalently as:

\begin{subequations}
\begin{eqnarray}
\nabla\left(\frac{\partial\phi}{\partial t}+\frac{1}{2}V^2+h\right)&=&0\\
\frac{\partial}{\partial t}\left(\frac{\partial\phi}{\partial t}+\frac{1}{2}V^2+h\right)&=&0\\
\frac{\partial^2\phi}{\partial t^2}+\frac{1}{2}\frac{\partial (\nabla\phi)^2}{\partial t}+\frac{\partial h}{\partial t}&=&0
\end{eqnarray}
\end{subequations}

Inserting the thermodynamic relationship between enthalpy and pressure that is valid for isentropic flows:

\beq
\label{eq:R2}
\frac{\partial^2\phi}{\partial t^2}+\frac{1}{2}\frac{\partial (\nabla\phi)^2}{\partial t}+\frac{c^2}{\rho}\frac{\partial\rho}{\partial t}=0
\eeq

Inserting Eqs. \eqref{eq:R1}b and \eqref{eq:R2} into Eq. \eqref{eq:ContinuityEqnPotential} gives the potential flow equation:

\beq
\label{eq:PotentialFlowModel}
\left(\delta_{ij}-Ma_iMa_j\right)\frac{\partial^2\phi}{\partial x_i\partial x_j}=\frac{1}{c^2}\left(\frac{\partial^2\phi}{\partial t^2}+\frac{\partial(\nabla\phi)^2}{\partial t}\right)
\eeq

where \(Ma_i\equiv V_i/c\). Recall that this equation is valid for irrotational and isentropic flow.

\subsection{The Influence of Mach Number}
For sufficiently small Mach numbers, the flow can be assumed incompressible, and the error made in assuming incompressible flow can be quantified based on the magnitude of the Mach number. Expand the stagnation pressure for an ideal gas in a power series about the Mach number:

\begin{subequations}
\label{eq:MachExpansion}
\begin{eqnarray}
\frac{P_{stag}}{P}&=&\ 1+\frac{\gamma}{2}Ma^2+\frac{\gamma}{8}Ma^4+\frac{\gamma(2-\gamma)}{48}Ma^6+\mathscr{O}(Ma^8)\\
P_{stag}&=&\ P+\frac{1}{2}\rho V^2+\frac{\gamma}{8}Ma^4+\frac{\gamma(2-\gamma)}{48}Ma^6+\mathscr{O}(Ma^8)
\end{eqnarray}
\end{subequations}

As can be seen, the leading two terms contributing to the stagnation pressure are the thermodynamic pressure and the dynamic pressure. For an incompressible fluid, the Bernoulli equation shows that the stagnation pressure is simply equal to the sum of these first two terms. So, the influence of compressibility on the stagnation pressure is manifested in the \(\mathscr{O}(Ma^4)\) term. When scaled relative to the thermodynamic or dynamic pressures, the relative correction on these terms due to compressibility effects can be approximated. The relative correction on the thermodynamic pressure is:

\beq
\label{eq:PTCorrection}
\frac{\gamma}{8}Ma^4
\eeq

while the relative correction on the dynamic pressure is:

\beq
\label{eq:PDCorrection}
\frac{Ma^2}{4}
\eeq

These effects become of equal importance at \(Ma=\sqrt{2/\gamma}\), where below this limit the dynamic pressure correction is generally more significant than the thermodynamic pressure correction.

\subsection{Shock Conditions}

The Rankine-Hugoniot conditions are the boundary conditions imposed at a shock surface, which are simply the same boundary conditions that are derived from consideration of a general interface:

\beq
\rho\vv{V}'\cdot\vv{n}\biggr\lvert_{1}^{2}
\eeq

\beq
\label{eq:StagPressureJump}
\rho V_i'\vv{V}'\cdot\vv{n}\biggr\rvert_{1}^2=P\biggr\rvert_{1}^2
\eeq

\beq
\rho H\vv{V}'\cdot\vv{n}\biggr\rvert_{1}^2=0
\eeq

where \(\vv{V}'\) is the velocity of a control volume moving relative to the interface and \(1\) and \(2\) denote the two sides of the shock (in the directions normal to the shock). Eq. \eqref{eq:StagPressureJump} shows that the stagnation pressure is not constant over the jump. For the ideal gas law, variation in the stagnation pressure is related to a variation in entropy, which shows that entropy must change over a shock \cite{hirsch}. If the shock intensity is uniform, then the region downstream of the shock can be isentropic, in which case the entire flow domain is still irrotational. But, for shocks of nonuniform intensity, such as curved shocks, the entropy generation downstream is also nonuniform, in which case vorticity is generated downstream. So, even for an initially irrotational flow, the Euler equations {\it can} generate vorticity via nonuniform intensity shocks. This feature will be important in explaining the occurrence of flow separation for inviscid transonic flows in Section \ref{sec:Supersonic}.

The jump in entropy over a shock must be positive from the second law of thermodynamics, though mathematically, the Euler equations permit both positive and negative entropy jumps as solutions. So, the solution of the Euler equations must be supplanted by an entropy condition that guarantees that entropy increase across a shock. Because the right-hand side of Eq. \eqref{eq:EntropyEquation} must always be positive, this entropy condition requires that in the limit of vanishing viscosity and thermal conductivity:

\beq
\frac{\partial s}{\partial t}+\vv{V}\cdot\nabla s\geq0
\eeq

\subsection{Incompressible Flow}

The Navier-Stokes equations are so frequently written in incompressible form (without a disclaimer) that many people (including myself once upon a time) believed that the incompressible form was valid for compressible flows. The continuity equation simplifies by setting the time derivative and gradient of density to zero (i.e. the material derivative of density is zero), giving:

\beq
\nabla\cdot\vv{V}=0
\eeq

Note that the condition for incompressibility arising from the continuity equation is {\it not} that \(d\rho/dt=0\) - it is that the velocity field is divergence-free. Taking the \(x\)-direction Navier-Stokes equation in Cartesian coordinates for an incompressible fluid (\(\nabla\cdot\vv{V}=0\)) as an example:

\beqa
\rho&\left(\frac{\partial V_x}{\partial t}+V_x\frac{\partial V_x}{\partial x}+V_y\frac{\partial V_x}{\partial y}+V_z\frac{\partial V_x}{\partial z}\right)-\rho g_x+\frac{\partial P}{\partial x}=\\
&\hspace{0.75cm}\frac{\partial}{\partial x}\left\lbrack\mu\left(\frac{\partial V_x}{\partial x}+\frac{\partial V_x}{\partial x}\right)\right\rbrack+\frac{\partial}{\partial y}\left\lbrack\mu\left(\frac{\partial V_x}{\partial y}+\frac{\partial V_y}{\partial x}\right)\right\rbrack+\frac{\partial}{\partial z}\left\lbrack\mu\left(\frac{\partial V_x}{\partial z}+\frac{\partial V_z}{\partial x}\right)\right\rbrack\\
&\hspace{0.75cm}\frac{\partial}{\partial x}\left(\mu\frac{\partial V_x}{\partial x}\right)+\frac{\partial}{\partial y}\left(\mu\frac{\partial V_x}{\partial y}\right)+\frac{\partial}{\partial z}\left(\mu\frac{\partial V_x}{\partial z}\right)+\frac{\partial}{\partial x}\left\lbrack\mu\left(\cancel{\frac{\partial V_x}{\partial x}+\frac{\partial V_y}{\partial y}+\frac{\partial V_z}{\partial z}}\right)\right\rbrack\\
\eeqa

where the continuity equation for an incompressible fluid is used to cancel the last term. This gives, in vector notation, the Navier-Stokes equation for an incompressible fluid:

\begin{subequations}
\label{eq:NSIncompressibleMomentum}
\begin{eqnarray}
\rho\frac{d\vv{V}}{dt}&=&\rho\vv{g}-\nabla P+\nabla\cdot(\mu\nabla\vv{V})\\
\rho\frac{d\vv{V}}{dt}&=&\rho\vv{g}-\nabla P+\mu\nabla^2\vv{V}
\end{eqnarray}
\end{subequations}

where an additional simplifying assumption of constant viscosity is often made, giving Eq. \eqref{eq:NSIncompressibleMomentum}b. The incompressible form of the fluid energy equation can be derived by first expanding all gradients on the LHS:

\begin{subequations}
\begin{eqnarray}
\frac{\partial (\rho E)}{\partial t}+\frac{\partial}{\partial x_i}\left(\rho hV_i\right)&=&\rho g_iV_i+\frac{\partial}{\partial x_i}\left(\tau_{ij}V_j\right)-\frac{\partial q_i}{\partial x_i}\\
\rho\frac{\partial E}{\partial t}+E\cancel{\frac{\partial\rho}{\partial t}}+V_i\frac{\partial}{\partial x_i}\rho h+\rho h\cancel{\frac{\partial V_i}{\partial x_i}}&=&\rho g_iV_i+\frac{\partial}{\partial x_i}\left(\tau_{ij}V_j\right)-\frac{\partial q_i}{\partial x_i}
\end{eqnarray}
\end{subequations}

Inserting the definition for \(\tau\) for an incompressible fluid:

\beq
\rho\frac{\partial E}{\partial t}+V_i\frac{\partial}{\partial x_i}\rho h=\rho g_iV_i+\frac{\partial}{\partial x_i}\left\lbrack\mu V_j\left(\frac{\partial V_i}{\partial x_j}+\frac{\partial V_j}{\partial x_i}\right)\right\rbrack-\frac{\partial q_i}{\partial x_i}
\eeq

Switching the order of integration on the second term on the RHS allows the incompressibility condition to again cancel one term, where for simplicity it has been assumed that \(\mu\) is constant. This gives the incompressible form of the conservative energy equation:

\beq
\rho\frac{\partial E}{\partial t}+\vv{V}\cdot\nabla(\rho h)=\rho\vv{V}\cdot\vv{g}+\mu\nabla\cdot\left((\nabla\vv{V}+(\nabla\vv{V})^T)\cdot\vv{V}\right)-\nabla\cdot\vv{q}
\eeq

For the incompressible flow equations, the three components of velocity and two thermodynamic quantities are the solution variables. Pressure no longer has a relationship to density through an EOS, and the incompressible Navier-Stokes equations are equations in terms of pressure, energy/temperature, and three components of velocity. Because an EOS cannot be used to specify pressure, the incompressible Navier-Stokes equations must be modified so that an evolution equation for pressure is obtained. A Pressure-Poisson equation is obtained by taking the divergence of the momentum equation:

\begin{subequations}
\label{eq:PP}
\begin{eqnarray}
\frac{\partial V_j}{\partial x_i}\frac{\partial V_i}{\partial x_j}&=&-\frac{1}{\rho}\frac{\partial^2 P^{'}}{\partial x_i^2}\\
\nabla\cdot(\vv{V}\cdot\nabla\vv{V})&=&-\frac{1}{\rho}\nabla^2P'
\end{eqnarray}
\end{subequations}

where \(\mu\) was assumed constant and \(P'\) is the reduced pressure. Satisfaction of the Pressure-Poisson equation is a necessary condition to satisfy incompressibility. The non-evolutionary feature of the \(\nabla\cdot\vv{V}=0\) condition (which results in a time-independent equation for pressure) makes the incompressible flow equations somewhat difficult to solve.

For incompressible flow that is also isothermal, the energy equation becomes decoupled from the mass and momentum equations because none of the thermal properties like viscosity and thermal conductivity are temperature-dependent.

\section{The Mathematical Structure of the Fluid Equations}
This section discusses the mathematical structure of systems of differential equations that will be important in selecting which form of the conservation equations to implement numerically. The previous section showed many equivalent forms of the Navier-Stokes equations, so this section attempts to describe why certain forms are more preferable from a numerical point of view. The mathematical properties of equations are complicated by the fact that the properties can be very different depending on if time dependence is included or neglected. 

A good way to begin this discussion is to look at the mathematical properties of two sets of equations that describe the same physics, but have different forms. For isentropic, irrotational, and steady flow, both the time-independent Euler equations (assuming the initial conditions correspond to isentropic flow) and the potential flow equations, are equivalent. The Euler equations in two dimensions are:

\begin{subequations}
\label{eq:2DEuler}
\begin{eqnarray}
\rho\frac{\partial u}{\partial x}+\rho\frac{\partial v}{\partial y}+u\frac{\partial\rho}{\partial x}+v\frac{\partial\rho}{\partial y}&=&0\\
u\frac{\partial u}{\partial x}+v\frac{\partial u}{\partial y}&=&-\frac{c^2}{\rho}\frac{\partial\rho}{\partial x}\\
u\frac{\partial v}{\partial x}+v\frac{\partial v}{\partial y}&=&-\frac{c^2}{\rho}\frac{\partial\rho}{\partial y}
\end{eqnarray}
\end{subequations}

The (physically) equivalent potential flow equation from Eq. \eqref{eq:PotentialFlowModel} in two dimensions is:

\beq
\left(1-\frac{u^2}{c^2}\right)\frac{\partial^2\phi}{\partial x^2}-2\frac{uv}{c^2}\frac{\partial^2\phi}{\partial x\partial y}+\left(1-\frac{v^2}{c^2}\right)\frac{\partial^2\phi}{\partial y^2}=0
\eeq

For the potential flow equations, if the flow is simplified to unidirectional velocity, then it can be seen that the equation has a Laplacian-like behavior, except that the ``diffusion coefficients'' on the second derivatives are different. For supersonic flows, one coefficient will be positive, while the other will be negative! This behavior is not present in the two-dimensional Euler equations, and will lead to different numerical properties.

\subsection{Wave Solutions for Simple Equations}
This section discusses wave solutions for two of the simplest equations - linear convection and linear diffusion. The linear convection equation is:

\beq
\frac{\partial u}{\partial t}+a(u)\frac{\partial u}{\partial x}=0
\eeq

If \(a(u)=u\), the above equation is known as ``Burger's equation,'' which has many known analytical solutions. Burger's equation permits discontinuous solutions from {\it initially continuous} data, i.e. the formation of shocks. For linear convection, the convection velocity \(a(u)\rightarrow a\) is a constant, so that the initial condition \(u_o\) is simply translated in space:

\beq
u(x,t)=u_o(x-at)
\eeq

This is a wave solution, which can be expressed as some amplitude \(\hat{u}\) multiplied by a complex exponential:

\beqa
\label{eq:1DWave}
u=&\ \hat{u}e^{\frac{2\pi i}{\lambda}(x-at)}\\
=&\ \hat{u}e^{i(kx-\omega t)}\\
\eeqa

where \(\lambda\) is the wavelength of the wave, \(k=2\pi/\lambda\) is the wavenumber, \(\omega=2\pi f\) is the pulsation, \(f\) is the frequency, and \(a\equiv\lambda f\) is the speed of the wave. The \(2\pi/\lambda\) factor is simply a normalization constant. Therefore, pure convection is a wave phenomenon, and as such can be described using properties of waves. The solution is constant along lines \(dx/dt=a\). Diffusion, while not strictly a wave phenomenon, can be interpreted as such by seeking a solution in the form above to the pure diffusion equation:

\beq
\frac{\partial u}{\partial t}=\alpha \frac{\partial^2u}{\partial x^2}
\eeq

where \(\alpha\) is the diffusivity. By plugging in the assumed form for the solution gives:

\beq
a=\alpha\frac{2\pi}{i\lambda}
\eeq

Substituting this purely imaginary wave speed into the assumed solution gives:

\beq
u=\hat{u}e^{\frac{2\pi i}{\lambda}x}e^{-\frac{4\pi^2}{\lambda^2}\alpha t}
\eeq

So, a purely diffusive solution {\it can} be represented as a wave, but that wave is exponentially damped in time. If the diffusion coefficient is negative, then the wave grows exponentially in time, which does not correspond to a diffusive process (which by definition acts to {\it reduce}, not increase, gradients of \(u\)). 

\subsection{Mathematical Properties of Time-Independent Equations}
Based on the plane wave solutions discussed in the previous section, we can extend the types of waves permitted by a differential equation to provide a definition of the mathematical character of that equation or system of equations. A system of time-independent equations is characterized based on its homogeneous part:

\begin{itemize}
\item Hyperbolic - permits wave-like solutions,
\item Parabolic - permits damped wave solutions), or
\item Elliptic - does not permit wave-like solutions
\end{itemize}

Recognizing that any second-order system can be written as a system of first-order PDEs (though this transformation is not necessarily unique and could lead to an artificially degenerate system), we will consider the following general first-order PDE:

\beq
\label{eq:SteadyStateEqn}
A_j\frac{\partial U}{\partial x_j}=Q
\eeq

Now, assume a wave-like solution for all components of the solution vector \(U\):

\beqa
\label{eq:WaveSolution}
U=&\hat{U}e^{i\vv{k}\cdot\vv{x}}\\
=&\hat{U}e^{in_jx_j}\\
\eeqa

where \(\vv{x}\) is a vector representing the spatial coordinate and \(\vv{k}\) is a normal at that coordinate. Each component of \(\vv{k}\) can be interpreted as the wave number in that direction (or proportional to the number of wavelengths in that direction). This is identical to the one-dimensional solutions shown in the previous section, where the time-independent part of the exponential had the form \(kx\), but now has the form \(\vv{k}\cdot\vv{x}\). To determine the character of a system of first-order PDEs, introduce this assumed solution into the homogeneous form of the PDE:

\beqa
\label{eq:Condition}
A_j\frac{\partial}{\partial x_j}\left(\hat{U}e^{ik_jx_j}\right)=&0\\
A_jik_j\hat{U}e^{ik_jx_j}=&0\\
A_jk_j\hat{U}=&0\\
\eeqa

The above equation states that the coefficients of the solution, when assuming a wave-like solution, lie in the nullspace of the matrix formed by the linear combination of the matrices \(A\) with the components of the normal vector \(\vv{k}\). For this time-independent system, the mathematical character is based on the components of \(\vv{k}\):

\begin{itemize}
\item Hyperbolic - all real (with linearly independent solutions)
\item Parabolic - all real (with some linearly dependent solutions)
\item Elliptic - all complex
\end{itemize}

Parabolic equations usually arise when there is a combination of convection and diffusion, while elliptic equations generally correspond to purely diffusive systems. We can use these definitions to investigate the time-independent Euler equations in Eq. \eqref{eq:2DEuler}. These equations are solved for the two components of velocity and density, giving the following matrix system:

\beq
\begin{bmatrix}
u & \rho & 0\\
c^2/\rho & u & 0\\
0 & 0 & u\\
\end{bmatrix}
\frac{\partial}{\partial x}\begin{bmatrix}\rho \\ u \\ v\end{bmatrix}+
\begin{bmatrix}
v & 0 & \rho\\
0 & v & 0\\
c^2/\rho & 0 & v
\end{bmatrix}
\frac{\partial}{\partial y}\begin{bmatrix}\rho \\ u \\ v\end{bmatrix}=0
\eeq

To satisfy Eq. \eqref{eq:Condition}, we require:

\beq
\text{det}\left(\begin{bmatrix}
uk_x+vk_y & \rho k_x & \rho k_y\\
c^2k_x/\rho & uk_x+vk_y & 0\\
c^2k_y/\rho & 0 & uk_x+vk_y
\end{bmatrix}\right)=0
\eeq

This gives the following solutions for \(k_x\) and \(k_y\):

\begin{subequations}
\begin{eqnarray}
\frac{k_x}{k_y}&=&-\frac{v}{u}\\
\frac{k_x}{k_y}&=&\frac{-uv\pm c^2\sqrt{Ma^2-1}}{u^2-c^2}
\end{eqnarray}
\end{subequations}

where the Mach number has been introduced. The first solution is always real. For subsonic flow, two solutions are complex, in which case the system of equations is hybrid hyperbolic-elliptic. For supersonic flow, all solutions are real, and the system is fully hyperbolic. Exactly at \(Ma=1\), the components of the normal are not unique, in which case the system is parabolic. This strong flow-regime dependence on the character of the solutions makes creating numerical methods for all ranges challenging. 

Carrying out the same analysis for the steady 2-D potential flow equations, we find that for subsonic flows, the equations are purely elliptic, while for supersonic flows they are also purely hyperbolic. Exactly at \(Ma=1\), the normal components are not unique, and the system is parabolic. So, despite the Euler and potential flow equations describing the same set of physics (for uniform inlet conditions), the Euler equations are hybrid elliptic-hyperbolic for subsonic flows, while the potential flow equations are purely elliptic. Hyperbolic equations permit shocks, so both the stationary Euler and potential flow equations permit shocks for supersonic flows.

The characteristic normals correspond to characteristic surfaces \(S\). The normal to a surface is equivalent to taking the gradient of that surface:

\beq
\vv{k}=\nabla S
\eeq

Substituting this form into the generic wave solution for time-independent systems gives:

\beqa
U=&\ \hat{U}e^{i\nabla S\cdot\vv{x}}\\
=&\ \hat{U}e^{i\frac{\partial S}{\partial x_j}x_j}
\eeqa

The solution is constant along constant values of \(x_j\frac{\partial S}{\partial x_j}\). So, along the direction of the normal \(\vv{k}\), \(U\) is constant. To have real normals in the solution can be physically interpreted as convection at constant values being permitted in those directions. If the normals are complex, then the solution does not propagate at equal value along any direction (a characteristic of convection, as seen from the 1-D convection solution). \(S\) is also known as a wavefront surface, because it separates the space domain that has already influenced the propagating \(U\) from the points not yet reached by the wave. Propagation at constant value occurs normal to the wavefront surface. For a purely hyperbolic system of \(n\) unknowns, there will be \(n\) unique characteristic surfaces, with normals along which each of the \(n\) unknowns propagates at constant value. Knowing the components of the normal, the surface (at a point) is parallel to the tangent plane defined by the location at which the component of the normal onto a vector \(d\vv{x}\) is zero:

\beqa
\nabla S\cdot d\vv{x}=&\frac{\partial S}{\partial x}dx+\frac{\partial S}{\partial y}dy+\frac{\partial S}{\partial z}dz\\
=&k_xdx+k_ydy+k_zdz\\
=&0
\eeqa

In 2-D, the direction of the characteristic line (perpendicular to the characteristic normal) is therefore:

\beq
\frac{dy}{dx}=-\frac{k_x}{k_y}
\eeq

For a problem in \(n\) space dimensions, at each point there are \(n\) characteristics, defined by the components of the normals at those locations found by taking the determinant of the matrix system. Those characteristics propagate from every point. At any point in space, the solution can be obtained from the characteristics that have propagated from the boundary to that location. This allows the definition of the region of dependence of a point consisting of all of the points in space that can physically influence that point's value. Likewise, the zone of influence is the region of points in space that can be physically influences by that point's value. For parabolic problems, the characteristic normals are not all unique, in which case the region of dependence of a point is no longer an \(n\)-dimensional space - it is of reduced order so that the amount of points influencing the point is smaller (smaller/collapsed regions of dependence). For elliptic problems, because there are no real characteristics, the solution at a point depends on all other points, so the zone of influence and the region of dependence consist of the entire space of the domain, and are identical.

\subsection{Mathematical Properties of Time-Dependent Equations}

A common solution technique for steady-state problems is to treat the problem as time-dependent, but march forward in time using a time-dependent system of equations until reaching a nearly steady-state system. When including time dependence, Eq. \eqref{eq:SteadyStateEqn} becomes:

\beq
\label{eq:TransientEqn}
\frac{\partial U}{\partial t}+A_j\frac{\partial U}{\partial x_j}=Q
\eeq

We can use the same analysis framework used above for the time-independent equations by introducing an additional component into \(\vv{x}\), which initially only represented the spatial coordinates. We now define \(U=\begin{bmatrix}U & t\end{bmatrix}^T\), where it is clear that the flux Jacobian matrix for this new component is simply the identity matrix. The assumed wave solution now includes an additional component in the exponent in Eq. {eq:WaveSolution}:

\beq
U=\hat{U}e^{i(\nabla S\cdot\vv{x}+\frac{\partial S}{\partial t}t)}
\eeq

where we have expanded \(\nabla S\cdot\vv{x}\) to the strictly spatial component \(\vv{x}\) and the new time component. By comparing this to the 1-D wave solution in Eq. \eqref{eq:1DWave}, it can be seen that \(\partial S/\partial t=-\omega\). The solution is now constant along:

\beq
\label{eq:TransientConstant}
\vv{x}\cdot\nabla S+t\frac{\partial S}{\partial t}=0
\eeq

\(\nabla S\) is now the normal to the characteristic surface at the intersection point with surfaces of constant \(t\). Plugging this assumed solution into Eq. \eqref{eq:TransientEqn} gives:

\begin{subequations}
\begin{eqnarray}
\left(\frac{\partial S}{\partial t}+A_j\frac{\partial S}{\partial x_j}\right)\hat{U}&=&0\\
\left(-\omega\delta_{ij}+A_j\frac{\partial S}{\partial x_j}\right)\hat{U}&=&0
\end{eqnarray}
\end{subequations}

Therefore, we require that the determinant of the above matrix equal zero, which from basic understanding of eigenvalue problems, reveals that the wave pulsations are the eigenvalues of \(A_j\frac{\partial S}{\partial x_j}=A_jk_j\). Divide both sides by the norm of the wave number vector so that \(\omega\) then represents the wave speeds \(a\):

\beq
\left(-a\delta_{ij}+\frac{A_j}{\|\vv{k}\|}\frac{\partial S}{\partial x_j}\right)\hat{U}=0
\eeq

Therefore, the eigenvalues are multiples of the wave speeds. For systems of equations, mathematical character is now based on the eigenvalues of the time-independent portion of the homogeneous system -

\begin{itemize}
\item Hyperbolic - all real
\item Parabolic - all purely imaginary
\item Elliptic - all complex
\end{itemize}

The solutions \(\hat{U}\) are the eigenvectors for this homogeneous equation set, and the solution to the inhomogeneous problem can be constructed as a linear combination of these eigenvectors. Elliptic systems have complex eigenvalues of the form \(\omega=\xi+i\eta\). Substituting this into the solution gives two solutions, where the second solution arises because all of the entries in the flux Jacobians are real (so all eigenvalues are associated with their complex conjugates as well):

\begin{subequations}
\begin{eqnarray}
U&=&\hat{U}e^{i\nabla S\cdot\vv{x}}e^{-i\xi t}e^{\eta t}\\
U&=&\hat{U}e^{i\nabla S\cdot\vv{x}}e^{-i\xi t}e^{-\eta t}
\end{eqnarray}
\end{subequations}

Therefore, elliptic systems are characterized by one solution that is damped in time, while another that is amplified in time. Performing the same analysis for the Euler equations as previously, but including the time derivative, in 2-D the two eigenvalues are \(a=u, u\pm c\). These are always real, so the time-dependent Euler equations are fully hyperbolic. Recall from the time-independent analysis that the mathematical character of the Euler equations was dependent on the Mach number. This example shows that once time dependence is considered, the mathematical nature of equations generally becomes independent of the flow regime, which allows the design of numerical methods that are accurate over all flow regimes.

%Only incompressible potential flow problems are linear, so the properties of these nonlinear equations might also depend on the values of variables and constants that appear. In other words, the behavior of the equations is dependent on the flow regime!

\subsection{Constructing a Well-Posed System}

To close the system of equations, we must specify initial and/or boundary conditions. But, these conditions cannot be specified arbitrarily - they must be specified in such a way as to create a well-posed system. A system is well-posed if the solution depends continuously on the imposed conditions, i.e. a small perturbation in the initial and boundary conditions causes a correspondingly small perturbation in the solution. For example, because the solution is a linear combination of the eigenvectors, the boundary conditions cannot cause the system to have a complex eigenvalue, because then one solution will grow exponentially in time such that a small perturbation of the conditions does not lead to a correspondingly small perturbation in the domain. For \(n\) eigenvalues (entries in \(U\)), we can denote whether those eigenvalues are real and complex (I will bundle the purely imaginary eigenvalues into \(n_c\) because they just have a zero real component, and still have the exponential growth property of one of the complex conjugates):

\beq
n=n_r+n_c
\eeq

\begin{table}[H]
\caption{Number of conditions required for hyperbolic, elliptic, and parabolic systems of equations. Pure BVP are undefined for hyperbolic equations. Pure IVP are undefined for elliptic and hybrid equations. Boundary conditions apply on {\it all} locations on a boundary unless otherwise noted.}
\centering
\begin{tabular}{l l l l}
\hline\hline
& Eigenvalue properties & Problem type & Initial conditions & Boundary conditions\\ [0.5ex]
\hline
\multirow{2}{*}{hyperbolic} & \multirow{2}{*}{\(n\)} real & IVP & \(n\) & 0\\
 & IVBP & \(n\) & \(n\), but only on inflow boundaries (positive eigenvalue at that {\it point})\\
\multirow{1}{*}{elliptic} & \multirow{1}{*}{\(n_c\) complex} & IVBP & \(n_c\) & \(n_c/2\)\\
hybrid & \(n_r\) real and \(n_c\) complex & IVBP & \(n_r+n_c/2\)? & \(n_r+n_c/2\), \(n_r\) only on inflow boundaries\\
parabolic & \(n_c\) pure imaginary & IVBP & \(n_c\) & \(n_c/2\)
parabolic-hyperbolic & \(n_r\) real and \(n_c\) imaginary & IVBP & \(n_r\) & \(n_c\)\\
\end{tabular}
\label{table:Regimes}
\end{table}

There are no general global existence theorems for non-stationary compressible Navier-Stokes equations with a given set of BCs and ICs, so there are no practical rules for establishing BCs.

\subsubsection{Initial Conditions}
If the system is hyperbolic, you need \(n\) initial conditions. If the problem is elliptic or hybrid, then only \(n_r+n_c/2\) initial conditions can be specified, since the components with the negative imaginary component will grow exponentially in time and not satisfy our ``well-posedness'' condition. It does not make sense to run an initial value problem with less than \(n\) initial conditions, so a pure initial value problem is only well-defined for a hyperbolic system. Similarly, because \(n\) initial conditions must be specified for a hyperbolic system, the specification of any less than this number will also not be a well-posed system; a pure boundary value problem for a hyperbolic system is not well posed.

Parabolic systems also require \(n\) initial conditions, but they also require boundary conditions.

Pure initial value problems are only well-defined for hyperbolic problems. Likewise, pure boundary value problems are ill-posed for hyperbolic problems.


\subsubsection{Boundary Conditions}
For an elliptic system, because all of the eigenvalues are complex, \(n/2\) boundary conditions must be imposed on {\it every} part of the boundary. For hyperbolic systems, \(n\) boundary conditions have to be distributed along the boundaries at all values in time according to the propagation direction of the corresponding waves. If the wave number is in the direction of the interior normal vector, then that waves will propagate information inside the domain provided the velocity is positive. So, the number of BCs to impose for a hyperbolic IVBP at a point on a boundary equals the number of positive eigenvalues at that point.

For parabolic problem \(n/2\) boundary conditions must be imposed. The standard form for parabolic equations is \(\partial u/\partial t=L(u)\), where \(L\) is a second order elliptic operator in space.

For hybrid problems, \(n_r\) boundary conditions must be specified on boundaries on which the corresponding wave number vector propagates information inside the domain, and the remaining \(n_c/2\) conditions must be specified everywhere on the boundary.

The number of boundary conditions to impose is not the only consideration in defining a well-posed system - those boundary conditions often must still be selected carefully.

For a parabolic-hyperbolic set, the boundary conditions are of initial value type for the hyperbolic components, but boundary value type for elliptic.

The Navier-Stokes equations are parabolic in time and space.

\section{The Physics of Turbulence}

In the study of turbulence, many mathematical models separate the turbulent field into the sum of the mean field and a fluctuation, where a mean of \((.)\) is denoted with angled brackets \(\la(.)\ra\) and the fluctuation with a prime. For instance, the velocity is decomposed into:

\beq
\vv{V}(\vv{x},t)=\la\vv{V}(x,t)\rangle+\vv{V}(x,t)'
\eeq

This decomposition is sometimes referred to as a ``Reynolds decomposition.'' Likewise, all other turbulent quantities of interest can be decomposed into a mean and a fluctuation. 

\begin{tcolorbox}[breakable]
Some important statistical results are needed before carrying out the derivation of the averaged Navier Stokes equations. The results presented here will be used often in the derivation of turbulence models. A mean is defined as:

\beq
\la U\ra\equiv\int_{0}^{\infty}Vf(V)dV
\eeq

where \(f(V)\) is the PDF of \(V\). The mean of the mean is simply equal to the mean, since the integral of \(f(V)\) from 0 to \(\infty\) is by definition unity. 

\beqa
\la\la U\ra\ra=&\int_{0}^{\infty}\la U\ra f(V)dV\\
=&\la U\ra\\
\eeqa

The mean of the fluctuation is zero by the consequence of the fact that the mean of the mean is the mean:

\beqa
\la U'\ra\equiv&\int_{0}^{\infty}(V-\la V\ra)f(V)dV\\
\equiv& \int_{0}^{\infty}Vf(V)dV - \int_{0}^{\infty}\la V\ra f(V)dV\\
\equiv&\ \la U\ra - \la U\ra\\
\equiv&\ 0\\
\eeqa

The mean of the product of a fluctuation and a mean is zero, again due to the consequence that the mean of a mean is the mean:

\beqa
\la U'\la\rho\ra\ra\equiv&\int_{0}^{\infty}(V-\la V\ra)\la p\ra f(V)dV\\
\equiv&\int_{0}^{\infty}\left(V\la p\ra-\la V\ra\la p\ra\right)f(V)dV\\
\equiv&\la V\ra\la\rho\ra-\la V\ra\la\rho\ra\\
\equiv&\ 0\\
\eeqa

\end{tcolorbox}




\subsection{The Mean Flow Equations}

The mean flow equations are derived by substituting these decompositions into the Navier-Stokes equations and then taking the mean of the entire equation, where simplification often uses the fact that taking the mean and differentiation, with respect to both time and space, commute. 


\subsubsection{The Continuity Equation}
The continuity equation for compressible flow becomes:

\beqa
\frac{\partial \left(\la\rho\ra+\rho'\right)}{\partial t}+\nabla\cdot \left((\la\rho\ra+\rho')(\la\vv{V}\ra+\vv{V}')\right)=&0\\
\frac{\partial\la\rho\ra}{\partial t}+\frac{\partial\rho'}{\partial t}+\nabla\cdot \left(\la\rho\ra\la\vv{V}\ra+\la\rho\ra\vv{V}'+\la\vv{V}\ra\rho'+\rho'\vv{V}'\right)=&0\\
\frac{\partial\la\la\rho\ra\ra}{\partial t}+\cancel{\frac{\partial\la\rho'\ra}{\partial t}}+\nabla\cdot\left(\la\la\rho\ra\la\vv{V}\ra\ra+\cancel{\la\la\rho\ra\vv{V}'\ra}+\cancel{\la\la\vv{V}\ra\rho'\ra}+\la\rho'\vv{V}'\ra\right)=&0\\
\frac{\partial\la\rho\ra}{\partial t}+\nabla\cdot\left(\la\rho\ra\la\vv{V}\ra+\la\rho'\vv{V}'\ra\right)=&0\\
\eeqa

The detailed derivation of canceling terms is not shown for the remaining equations because they would take too long to type, but use the above example if confused. 

\subsubsubsection{Incompressible Flow}

For incompressible flow, the continuity equation simplifies to:

\beq
\label{eq:1}
\nabla\cdot\vv{V}=0
\eeq

Taking the average of this equation shows that the mean velocity field is divergence-free:

\beq
\label{eq:2}
\nabla\cdot\la\vv{V}\ra=0
\eeq

Alternatively, plugging in the Reynolds decomposition to Eq. \eqref{eq:1} gives:

\beq
\label{eq:3}
\nabla\cdot\la\vv{V}\ra+\nabla\cdot\vv{V}'=0
\eeq

Subtracting Eq. \eqref{eq:2} from Eq. \eqref{eq:3} shows that, for incompressible flow, both the mean of the velocity and the fluctuation in velocity are divergence-free. 


\subsubsection{The Momentum Equation}
The derivation for the momentum equation is more complicated, and is the fundamental reason why most studies of turbulent flow assume incompressibility.

\beqa
\frac{\partial(\rho V_i)}{\partial t}+\frac{\partial(\rho V_iV_j)}{\partial x_j}= \rho g_i+\frac{\partial}{\partial x_j}\left\lbrack-P\delta_{ij}+\mu\left(\frac{\partial V_i}{\partial x_j}+\frac{\partial V_j}{\partial x_i}\right)-\frac{2\mu}{3}\frac{\partial V_k}{\partial x_k}\delta_{ij}\right\rbrack\\
\frac{\partial((\la\rho\ra+\rho') (\la V_i\ra+V_i'))}{\partial t}+\frac{\partial((\la\rho\ra+\rho') (\la V_i\ra+V_i')(\la V_j\ra+V_j'))}{\partial x_j}-(\la\rho\ra+\rho') g_i= \quad\quad\\
\frac{\partial}{\partial x_j}\left\lbrack-(\la P\ra+P')\delta_{ij}+(\la\mu\ra+\mu')\left(\frac{\partial (\la V_i\ra+V_i')}{\partial x_j}+\frac{\partial (\la V_j\ra+V_j')}{\partial x_i}\right)-\frac{2(\la\mu\ra+\mu')}{3}\frac{\partial (\la V_k\ra+V_k')}{\partial x_k}\delta_{ij}\right\rbrack\\
\frac{\partial}{\partial t}\left(\la \rho\ra\la V_i\ra+\rho'\la V_i\ra+V_i'\la\rho\ra+\rho' V_i'\right)+\frac{\partial}{\partial x_j}\left(\la\rho\ra(\la V_i\ra\la V_j\ra+\la V_i\ra V_j'+\la V_j\ra V_i'+V_i'V_j')\right)+\\
\frac{\partial}{\partial x_j}\left(\rho'(\la V_i\ra\la V_j\ra+\la V_i\ra V_j'+\la V_j\ra V_i'+V_i'V_j')\right)-(\la\rho\ra +\rho')g_i= \quad\quad\\
\frac{\partial}{\partial x_j}\left\lbrack-(\la P\ra+P')\delta_{ij}+\mu'\frac{\partial (\la V_i\ra+V_i')}{\partial x_j}+\mu'\frac{\partial (\la V_j\ra+V_j')}{\partial x_i}+\la\mu\ra\frac{\partial (\la V_i\ra+V_i')}{\partial x_j}+\la\mu\ra\frac{\partial (\la V_j\ra+V_j')}{\partial x_i}\right\rbrack-\\
\frac{2}{3}\frac{\partial}{\partial x_j}\left\lbrack\mu'\frac{\partial (\la V_k\ra+V_k')}{\partial x_k}\delta_{ij}+\la\mu\ra\frac{\partial (\la V_k\ra+V_k')}{\partial x_k}\delta_{ij}\right\rbrack\\
\frac{\partial}{\partial t}\left(\la \rho\ra\la V_i\ra+\la\rho' V_i'\ra\right)+\frac{\partial}{\partial x_j}\left(\la\rho\ra\la V_i\ra\la V_j\ra+\la\rho'V_i'V_j'\ra\right)-\la\rho\ra g_i= \quad\quad\\
\frac{\partial}{\partial x_j}\left\lbrack-\la P\ra\delta_{ij}+\la\mu'\frac{\partial V_i'}{\partial x_j}\ra+\la\mu'\frac{\partial V_j'}{\partial x_i}\ra+\la\mu\ra\frac{\partial \la V_i\ra}{\partial x_j}+\la\mu\ra\frac{\partial \la V_j\ra}{\partial x_i}\right\rbrack-\frac{2}{3}\frac{\partial}{\partial x_j}\left\lbrack\la\mu'\frac{\partial V_k'}{\partial x_k}\delta_{ij}\ra+\la\mu\ra\frac{\partial \la V_k\ra}{\partial x_k}\delta_{ij}\right\rbrack
\eeqa

The momentum equation can also be written in terms of \(e_{ij}\) and its fluctuating component \(e_{ij}'\):

\beqa
\frac{\partial}{\partial t}\left(\la \rho\ra\la V_i\ra+\la\rho' V_i'\ra\right)+\frac{\partial}{\partial x_j}\left(\la\rho\ra\la V_i\ra\la V_j\ra+\la\rho'V_i'V_j'\ra\right)-\la\rho\ra g_i= \quad\quad\\
\frac{\partial}{\partial x_j}\left\lbrack-\la P\ra\delta_{ij}+2\la\mu'e_{ij}'\ra+2\la\mu\ra\la e_{ij}\ra\right\rbrack-\frac{2}{3}\frac{\partial}{\partial x_j}\left\lbrack\la\mu'\frac{\partial V_k'}{\partial x_k}\ra+\la\mu\ra\frac{\partial \la V_k\ra}{\partial x_k}\right\rbrack\delta_{ij}
\eeqa

Note that only the mean gravitational body force and the mean pressure have an impact on the mean flow.  Note that the Reynolds stresses for compressible flow have the form \(\la\rho V_i'V_j'\ra\), though because many texts focus their study exclusively on incompressible flow, it is common for the Reynolds stresses to be defined as \(\la V_i'V_j'\ra\), though this does not have the same units as stress. With the incompressible momentum equation, the only difference from the laminar Navier Stokes equation is the presence of the Reynolds stresses and the use of purely mean quantities. In the compressible Reynolds equations, in addition to the Reynolds stresses, there are \(2\la\mu'e_{ij}'\ra\) terms and \(\la\mu'\partial V_k'/\partial x_k\ra\) terms that represent momentum fluxes due to viscous and compressive forces in the turbulent field.


\subsubsubsection{Incompressible Flow}

For simplicity, the incompressible momentum equation will be the basis of most of the investigation of turbulence. Due to the incompressibility assumption, the gravitational body force can be bundled into a reduced pressure \(P'=P+\rho gz\), where for simplicity the prime is dropped, with the reduced pressure interpretation implied. Inserting the same Reynolds-decomposed quantities gives:

\beqa
\label{eq:AveNS}
\frac{\partial \vv{V}}{\partial t}+\frac{\partial}{\partial x_j}(V_iV_j)+\frac{1}{\rho}\frac{\partial P}{\partial x_i}-\nu\frac{\partial^2 V_i}{\partial x_j\partial x_j}=&0\\
\frac{\partial (\la V_i\ra+V_i')}{\partial t}+\frac{\partial}{\partial x_j}\left((\la V_j\ra+V_j')(\la V_i\ra+V_i')\right)+\frac{1}{\rho}\frac{\partial P}{\partial x_i}-\nu\frac{\partial^2 (\la V_i\ra+V_i')}{\partial x_j\partial x_j}=&0\\
\frac{\partial \la V_i\ra}{\partial t}+\frac{\partial V_i'}{\partial t}+\frac{\partial}{\partial x_j}\left(\la V_i\ra\la V_j\ra+\la V_i\ra V_j'+\la V_j\ra V_i'+V_i'V_j'\right)+\frac{1}{\rho}\frac{\partial P}{\partial x_i}-\nu\left(\frac{\partial^2 \la V_i\ra}{\partial x_j\partial x_j}+\frac{\partial^2 V_i'}{\partial x_j\partial x_j}\right)=&0\\
\frac{\partial \la V_i\ra}{\partial t}+\frac{\partial}{\partial x_j}\left(\la V_i\ra\la V_j\ra+\la V_i'V_j'\ra\right)+\frac{1}{\rho}\frac{\partial \la P\ra}{\partial x_i}-\nu\frac{\partial^2 \la V_i\ra}{\partial x_j\partial x_j}=&0\\
\eeqa

The averaged Navier-Stokes equations are identical to the Navier-Stokes equations, except that they describe averaged velocities and pressure, and include the Reynolds stress term \(\partial\la V_i'V_j'\ra/\partial x_i\). These evolution equations are not the end of the study of turbulence however, because closure relationships are needed to describe the Reynolds stresses in terms of other solution variables or known quantities. 




\subsubsection{The Energy Equation}

The mechanical energy equation is obtained by taking the scalar product of the momentum equation with velocity, which upon manipulation eventually gives an equation for the mechanical (often called kinetic) energy \(E\) per unit mass.

\beqa
\frac{\partial(\rho E)}{\partial t}+\frac{\partial}{\partial x_i}\left(\rho EV_i\right)=\rho g_iV_i+V_i\frac{\partial}{\partial x_j}\left(-P\delta_{ij}+\mu\left(\frac{\partial V_i}{\partial x_j}+\frac{\partial V_j}{\partial x_i}\right)-\frac{2\mu}{3}\frac{\partial V_k}{\partial x_k}\delta_{ij}\right)\\
\frac{\partial((\la\rho\ra+\rho') (\la E\ra+E'))}{\partial t}+\frac{\partial}{\partial x_i}\left((\la\rho\ra+\rho') (\la E\ra+E')(\la V_i\ra+V_i')\right)-(\la\rho\ra+\rho') g_i(\la V_i\ra+V_i')=\quad\quad\\
(\la V_i\ra+V_i')\frac{\partial}{\partial x_j}\left(-(\la P\ra+P')\delta_{ij}+(\la\mu\ra+\mu')\left(\la e_{ij}\ra+\la e_{ij}'\ra\right)-\frac{2(\la\mu\ra+\mu')}{3}\frac{\partial (\la V_k\ra+V_k')}{\partial x_k}\delta_{ij}\right)\\
\frac{\partial(\la\rho\ra\la E\ra+\la\rho'E'\ra)}{\partial t}+\frac{\partial}{\partial x_i}\left(\la\rho\ra\la E\ra\la V_i\ra+\la\rho'E'V_i'\ra\right)-\la\rho\ra\la V_i\ra g_i+\la\rho'V_i'\ra g_i+\left(\la V_i\ra\frac{\partial \la P\ra}{\partial x_j}+\la V_i'\frac{\partial P'}{\partial x_j}\ra\right)\delta_{ij}=\quad\quad\\
\la V_i\ra\frac{\partial(2\la\mu\ra\la e_{ij}\ra)}{\partial x_j}+\la V_i'\frac{\partial(2\mu'e_{ij}')}{\partial x_j}\ra-\frac{2}{3}\delta_{ij}\left\lbrack\la V_i\ra\frac{\partial}{\partial x_j}\left(\la\mu\ra\frac{\partial\la V_k\ra}{\partial x_k}\right)-\la V_i'\frac{\partial}{\partial x_j}\left(\mu'\frac{\partial V_k'}{\partial x_k}\ra\right)\right\rbrack\\
\eeqa

Note that, while the fluctuating pressure and density have no impact on the gravitational or pressure forces, because the covariance with the fluctuating velocity is non-zero, these two components have an impact on the mean energy equation. 


\subsubsubsection{Incompressible Flow}

For incompressible flow, the energy equation simplifies to:

\beqa
\frac{\partial E}{\partial t}+V_i\frac{\partial E}{\partial x_i}=&-\frac{V_i}{\rho}\frac{\partial}{\partial x_j}(P\delta_{ij})+2\nu V_i\frac{\partial e_{ij}}{\partial x_j}\\
\frac{\partial E}{\partial t}+V_i\frac{\partial E}{\partial x_i}=&-\frac{\partial}{\partial x_j}\left(\frac{PV_i}{\rho}\right)+2\nu\left(V_i\frac{\partial e_{ij}}{\partial x_j}+\frac{\partial V_i}{\partial x_j}e_{ij}\right)-2\nu\frac{\partial V_i}{\partial x_j}e_{ij}\\
\frac{\partial E}{\partial t}+V_i\frac{\partial E}{\partial x_i}=&-\frac{\partial}{\partial x_j}\left(\frac{PV_i}{\rho}\right)+2\nu\frac{\partial (V_ie_{ij})}{\partial x_j}-2\nu(e_{ij}+\xi_{ij})e_{ij}\\
\frac{\partial E}{\partial t}+V_i\frac{\partial E}{\partial x_i}+\frac{\partial}{\partial x_j}\left(\frac{PV_i}{\rho}-2\nu V_je_{ij}\right)=&-2\nu e_{ij}e_{ij}\\
\frac{\partial \la E\ra}{\partial t}+\la V_i\ra\frac{\partial \la E\ra}{\partial x_i}+\frac{\partial \la E'V_i'\ra}{\partial x_i}+\frac{\partial}{\partial x_j}\la\frac{PV_i}{\rho}-2\nu V_je_{ij}\ra=&-2\nu \left(\la e_{ij}\ra\la e_{ij}\ra+\la e_{ij}'e_{ij}'\ra\right)\\
\eeqa

where the product of the symmetric tensor \(e_{ij}\) with the antisymmetric tensor \(\xi_{ij}\) is zero. The first term on the right-hand side above represents dissipation due to the mean flow, while the second represents dissipation due to the fluctuating flow. In general, dissipation due to the main flow is of order \(Re^{-1}\), and hence becomes negligible relative to turbulent dissipation at high Reynolds number. 


By taking the scalar product of the incompressible Reynolds momentum equation with \(\la V_i\ra\), the mean flow kinetic energy \(\bar{E}\equiv\frac{1}{2}\la V_i\ra\la V_i\ra\) evolves according to:

\beqa
\frac{\partial\bar{E}}{\partial t}+\la V_j\ra\frac{\partial\bar{E}}{\partial x_j}+\la V_i\ra\frac{\partial}{\partial x_j}\la V_i'V_j'\ra+\frac{\partial}{\partial x_j}\left(\frac{\la P\ra\la V_j\ra}{\rho}\right)-\nu\la V_i\ra\frac{\partial^2\la V_i\ra}{\partial x_j^2}=&0\\
\frac{\partial\bar{E}}{\partial t}+\la V_j\ra\frac{\partial\bar{E}}{\partial x_j}+\frac{\partial}{\partial x_j}\left(\la V_i\ra\la V_i'V_j'\ra\right)+\frac{\partial}{\partial x_j}\left(\frac{\la P\ra\la V_j\ra}{\rho}\right)-2\nu\la V_i\ra\frac{\partial}{\partial x_j}\la e_{ij}\ra=&\la V_i'V_j'\ra\frac{\partial \la V_i\ra}{\partial x_j}\\
\frac{\partial\bar{E}}{\partial t}+\la V_j\ra\frac{\partial\bar{E}}{\partial x_j}+\frac{\partial}{\partial x_j}\left(\la V_i\ra\la V_i'V_j'\ra+\frac{\la P\ra\la V_j\ra}{\rho}-2\nu\la V_i\ra\la e_{ij}\ra\right)=&\underbrace{\la V_i'V_j'\ra\frac{\partial \la V_i\ra}{\partial x_j}}_{\textrm{production loss}}-\underbrace{2\nu\la e_{ij}\ra\la e_{ij}\ra}_{\textrm{mean dissipation}}\\
\eeqa

Likewise, by subtracting the Reynolds equations from the Navier-Stokes equations, an evolution equation for the turbulent kinetic energy can be derived. This equation can also be rewritten to explicitly show that the turbulent kinetic energy diffuses using the definitions for the dissipation and pseudo-dissipation in Eq. \eqref{eq:pseudo}.

\beqa
\frac{\partial k}{\partial t}+\la V_j\ra\frac{\partial k}{\partial x_j}+\frac{\partial}{\partial x_i}\left(\frac{1}{2}\la V_i'V_j'V_j'\ra+\frac{\la V_i'P'\ra}{\rho}-2\nu\la V_j'e_{ij}'\ra\right)=&\underbrace{-\la V_i'V_j'\ra\frac{\partial\la V_i\ra}{\partial x_j}}_{\textrm{production gain}}-\underbrace{2\nu\la e_{ij}'e_{ij}'\ra}_{\textrm{turbulent dissipation}}\\
\frac{\partial k}{\partial t}+\la V_j\ra\frac{\partial k}{\partial x_j}+\frac{\partial}{\partial x_i}\left(\frac{1}{2}\la V_i'V_j'V_j'\ra+\frac{\la V_i'P'\ra}{\rho}\right)=&-\la V_i'V_j'\ra\frac{\partial\la V_i\ra}{\partial x_j}-2\nu\la e_{ij}'e_{ij}'\ra+\nu\nabla^2 k-\tilde{\varepsilon}
\eeqa

As can be seen, the same term that is a loss from the mean flow kinetic energy is a source to the turbulent flow kinetic energy - kinetic energy is removed from the mean flow, and becomes a source to the turbulent flow. This production term is analogous to the deformation work \(\sigma_{ij}\partial V_i/\partial x_j\) that appears in the total energy equation. By analogy with products of symmetric and antisymmetric tensors, only the symmetric part of the velocity gradient tensor affects the production, and the production term \(\mathscr{P}\) could likewise be written as \(\la V_i'V_j'\ra\la e_{ij}\ra\). And, only the anisotropic component of the Reynolds stress tensor contributes to the production. If we assume the turbulent viscosity approximation, then it can be shown that this production term is exactly equal to the dissipation by the mean flow, but with the turbulent viscosity replacing the molecular viscosity. So, within the interpretation of the turbulent viscosity model, kinetic energy is removed from the main flow proportional to the turbulent viscosity, whereupon it becomes a source to the turbulent kinetic energy. 

\beqa
\mathscr{P}=&-\la V_i'V_j'\ra\frac{\partial \la V_i\ra}{\partial x_j}\\
=& -\la V_i'V_j'\ra\la e_{ij}\ra\\
=& -a_{ij}\la e_{ij}\ra\\
=& \ 2\nu_T\la e_{ij}\ra\la e_{ij}\ra\\
\eeqa

The dissipation of turbulent kinetic energy, \(\varepsilon\), which is always non-negative, is defined to be:

\beq
\varepsilon=2\nu\la e_{ij}'e_{ij}'\ra
\eeq

The fluctuating velocity gradients, working against the fluctuating deviatoric stress transform kinetic energy into internal energy (since energy is conserved, and the dissipation represents a loss from the kinetic energy equation). The resulting temperature increase due to turbulent kinetic energy transformation to internal energy is usually very small. An important characteristic can be learned about the dissipation by investigating the self-similar behavior of the round jet. We saw that the velocity and Reynolds stresses were self-similar, so we would therefore also expect the production term to be self-similar:

\beq
\hat{\mathscr{P}}=\frac{\mathscr{P}}{U_0^2}\frac{r_{1/2}}{U_0}
\eeq

From the turbulent kinetic energy equation, we would therefore expect the dissipation term to scale as \(\hat{\varepsilon}=\varepsilon r_{1/2}/U_0^3\). For two experiments with identical geometries and initial jet velocities using fluids of different viscosities, by self-similarity, the centerline velocity and half-widths at any particular \(x\) location will be the same. Consequently, by the self-similarity of the dissipation, the dissipation will also be the same. But, from the definition above, we see that the dissipation is proportional to the molecular viscosity. Because the viscosity is different between the two fluids, this implies that the lower-viscosity fluid must have higher \(\la e_{ij}'e_{ij}'\ra\) due to the finer scale structure of the flow, which leads to steeper gradients. The characteristic scales of the smallest turbulent motions are known as the Kolmogorov scales. These characteristic scales can be obtained by determining the combinations of scales \(\eta\) for length, \(\tau\) for time, and \(u\) for velocity in terms of viscosity and the turbulent kinetic energy:

\beqa
\eta=&\left(\frac{\nu^3}{\varepsilon}\right)^{1/4}\\
\tau=&\left(\frac{\nu}{\varepsilon}\right)^{1/2}\\
u=&\ (\nu\varepsilon)^{1/4}\\
\eeqa

It takes time \(\tau\) to dissipate an amount of energy \(k\) with constant dissipation rate \(\varepsilon\), but it also takes time \(\tau_P\) to produce energy \(k\) at constant rate \(\mathscr{P}\). For most flows, the production and dissipation are roughly equal, which causes turbulence to be long-lived. For the round jet, scale both sides such that the fundamental scales agree with the scaling for \(r\) and \(U\), and introduce the scaling for \(\varepsilon\) and the local Reynolds number \(Re_0=U_0r_{1/2}/\nu\):

\beqa
\frac{\eta}{r_{1/2}}=&\left(\frac{\nu^3r_{1/2}}{\hat{\varepsilon}U_0^3}\right)^{1/4}\frac{1}{r_{1/2}}=&Re_0^{-3/4}\hat{\varepsilon}^{-1/4}\\
\frac{\tau U_0}{r_{1/2}}=&\left(\frac{\nu r_{1/2}}{\hat{\varepsilon}U_0^3}\right)^{1/2}\frac{U_0}{r_{1/2}}=&Re_0^{-1/2}\hat{\varepsilon}^{-1/2}\\
\frac{u}{U_0}=&\ (\frac{\nu\hat{\varepsilon}U_0^3}{r_{1/2}})^{1/4}\frac{1}{U_0}=&Re_0^{-1/4}\hat{\varepsilon}^{1/4}\\
\eeqa

These Kolmogorov scales show that, recalling that the dissipation is independent of the Reynolds number, that the smallest lengthscales, timescales, and velocity scales decrease as the Reynolds number increases. This is the fundamental reason why the modeling of high Reynolds number, turbulent flows is so difficult - the mesh must be very fine. The Reynolds number based on the Kolmogorov scales is unity, which indicates that the motions on these scales is strongly impacted by viscosity. There would be no dissipation of turbulent kinetic energy in inviscid flows, and hence this signifies an unphysical turbulent flow. The turbulent dissipation is often the dominant term in the turbulent kinetic energy equation. Some texts will use a different definition of the turbulent kinetic energy dissipation, the pseudo-dissipation:

\beq
\label{eq:pseudo}
\tilde{\varepsilon}=\nu\la\frac{\partial V_i'}{\partial x_j}\frac{\partial V_i'}{\partial x_j}\ra
\eeq

Because \(e_{ij}\) is symmetric and \(\xi_{ij}\) antisymmetric:

\beqa
\la e_{ij}'e_{ij}'\ra=&\la e_{ij}'\left(e_{ij}'+\xi_{ij}'\right)\ra\\
=&\frac{1}{2}\la\left(\frac{\partial V_i'}{\partial x_j}\frac{\partial V_i'}{\partial x_j}+\frac{\partial V_i'}{\partial x_j}\frac{\partial V_j'}{\partial x_i}\right)\ra\\
\eeqa

which gives a relationship between the dissipation and pseudo-dissipation:

\beq
\varepsilon=\tilde{\varepsilon}+\nu\frac{\partial^2\la V_i'V_j'\ra}{\partial x_i\partial x_j}
\eeq

This second term on the right hand side is often only several percent of the total dissipation, so there is little problem with using the pseudo dissipation in place of the dissipation, and in some situations gives a simpler governing equation. 






\subsubsection{Cylindrical Coordinates}

These equations can also be derived in cylindrical coordinates for incompressible flow. The continuity equation becomes:

\beqa
\frac{1}{r}\frac{\partial(rV_r)}{\partial r}+\frac{1}{r}\frac{\partial V_{\theta}}{\partial\theta}+\frac{\partial V_z}{\partial z}=&0\\
\frac{1}{r}\frac{\partial(r\la\la V_r\ra+V_r'\ra)}{\partial r}+\frac{1}{r}\frac{\partial \la\la V_{\theta}\ra+V_{\theta}'\ra}{\partial\theta}+\frac{\partial \la\la V_z\ra+V_z'\ra}{\partial z}=&0\\
\frac{1}{r}\frac{\partial(r\la V_r\ra)}{\partial r}+\frac{1}{r}\frac{\partial \la V_{\theta}\ra}{\partial\theta}+\frac{\partial \la V_z\ra}{\partial z}=&0\\
\eeqa

where again, it is true that both \(\nabla\cdot\la \vv{V}\ra=0\) and \(\nabla\cdot\vv{V}'=0\). The three momentum equations are:

\beqa
\frac{\partial V_z}{\partial t}+V_z\frac{\partial V_z}{\partial z}+V_r\frac{\partial V_z}{\partial r}+\frac{V_{\theta}}{r}\frac{\partial V_z}{\partial\theta}=\frac{-1}{\rho}\frac{\partial P}{\partial z}+\nu\nabla^2 V_z\\
\frac{\partial \la V_z\ra}{\partial t}+\la (\la V_z\ra + V_z')\frac{\partial (\la V_z\ra + V_z')}{\partial z}\ra+\la \la (V_r\ra+V_r')\frac{\partial (\la V_z\ra + V_z')}{\partial r}\ra+\la\frac{\la V_{\theta}\ra+V_{\theta}'}{r}\frac{\partial (\la V_z\ra + V_z')}{\partial\theta}\ra=\frac{-1}{\rho}\frac{\partial \la P\ra}{\partial z}\nu\nabla^2\la V_z\ra\\
\frac{\partial \la V_z\ra}{\partial t}+\la V_z\ra\frac{\partial \la V_z\ra}{\partial z}+\la V_z'\frac{\partial V_z'}{\partial z}\ra+\la V_r\ra\frac{\partial \la V_z\ra}{\partial r}+\la V_r'\frac{\partial V_z'}{\partial r}\ra+\frac{1}{r}\left(\la V_{\theta}\ra\frac{\partial\la V_z\ra}{\partial\theta}+\la V_{\theta}'\frac{\partial V_z'}{\partial \theta}\ra\right)=\frac{-1}{\rho}\frac{\partial \la P\ra}{\partial z}+\nu\nabla^2\la V_z\ra\\
\eeqa

\beqa
\frac{\partial V_r}{\partial t}+V_z\frac{\partial V_r}{\partial z}+V_r\frac{\partial V_r}{\partial r}+\frac{V_{\theta}}{r}\frac{\partial V_r}{\partial\theta}=\frac{-1}{\rho}\frac{\partial P}{\partial r}+\nu\left(\nabla^2 V_r-\frac{V_r}{r^2}-\frac{2}{r^2}\frac{\partial V_{\theta}}{\partial\theta}\right)+\frac{V_{\theta}^2}{r}\\
\frac{\partial \la(\la V_r\ra + V_r')\ra}{\partial t}+(\la V_z\ra+V_z')\frac{\partial (\la V_r\ra + V_r')}{\partial z}\ra+\la(\la V_r\ra + V_r')\frac{\partial (\la V_r\ra + V_r')}{\partial r}\ra+\la\frac{\la V_{\theta}\ra+V_{\theta}'}{r}\frac{\partial (\la V_r\ra + V_r')}{\partial\theta}\ra=\\
\frac{-1}{\rho}\frac{\partial \la P\ra}{\partial r}+\nu\left(\nabla^2 \la V_r\ra-\frac{\la V_r\ra}{r^2}-\frac{2}{r^2}\frac{\partial \la V_{\theta}\ra}{\partial\theta}\right)+\frac{\la V_{\theta}\ra\la V_{\theta}\ra+\la V_{\theta}'V_{\theta}'\ra}{r}\\
\frac{\partial \la V_r\ra}{\partial t}+\la V_z\ra\frac{\partial \la V_r\ra}{\partial z}+\la V_z'\frac{\partial V_r'}{\partial z}\ra+\la V_r\ra\frac{\partial\la V_r\ra}{\partial r}+\la V_r'\frac{\partial V_r'}{\partial r}\ra+\frac{1}{r}\left(\la V_{\theta}\ra\frac{\partial \la V_r\ra}{\partial\theta}+\la V_{\theta}'\frac{\partial V_r'}{\partial\theta}\ra\right)=\\
\frac{-1}{\rho}\frac{\partial \la P\ra}{\partial r}+\nu\left(\nabla^2 \la V_r\ra-\frac{\la V_r\ra}{r^2}-\frac{2}{r^2}\frac{\partial \la V_{\theta}\ra}{\partial\theta}\right)+\frac{\la V_{\theta}\ra\la V_{\theta}\ra+\la V_{\theta}'V_{\theta}'\ra}{r}\\
\eeqa

For statistically axisymmetric flows, \(\la V_{\theta}\ra=\la V_r'V_{\theta}\ra=\la V_z'V_{\theta}'\ra=0\), and hence the above equations simplify to:

\beqa
\frac{\partial \la V_z\ra}{\partial t}+\la V_z\ra\frac{\partial \la V_z\ra}{\partial z}+\la V_r\ra\frac{\partial \la V_z\ra}{\partial r}=\frac{-1}{\rho}\frac{\partial \la P\ra}{\partial z}-\frac{\partial \la V_z'V_z'\ra}{\partial z}-\frac{1}{r}\frac{\partial (r\la V_r'V_z'\ra)}{\partial r}+\nu\nabla^2\la V_z\ra
\eeqa

\beqa
\frac{\partial \la V_r\ra}{\partial t}+\la V_z\ra\frac{\partial \la V_r\ra}{\partial z}+\la V_r\ra\frac{\partial\la V_r\ra}{\partial r}=\\
\frac{-1}{\rho}\frac{\partial \la P\ra}{\partial r}+\nu\left(\nabla^2 \la V_r\ra-\frac{\la V_r\ra}{r^2}\right)+\frac{\la V_{\theta}'V_{\theta}'\ra}{r}-\frac{\partial \la V_z'V_r'\ra}{\partial z}-\frac{1}{r}\frac{\partial(r\la V_r'V_r'\ra}{\partial r}\\
\eeqa





\subsubsection{Mean Scalar Equation}
Mean equations can also be developed for a conserved passive scalar \(\phi\) that has no impact on the flow field but is transported by both advection and diffusion governed by:

\beq
\frac{\partial\phi}{\partial t}+\nabla\cdot(\vv{V}\phi)=\Gamma\nabla^2\phi
\eeq

where \(\Gamma\) is the diffusivity. Inserting the Reynolds decomposition and taking the average of this governing equation gives:

\beqa
\frac{\partial\la\la\phi\ra+\phi'\ra}{\partial t}+\nabla\cdot\la(\la\vv{V}\ra+\vv{V}')(\la\phi\ra+\phi')\ra=&\Gamma\nabla^2\la\la\phi\ra+\phi'\ra\\
\frac{\partial\la\phi\ra}{\partial t}+\nabla\cdot(\la\vv{V}\ra\la\phi\ra+\la\vv{V}'\phi'\ra)=&\Gamma\nabla^2\la\phi\ra\\
\eeqa

\(\la\vv{V}'\phi'\ra\) represents the flux of \(\phi\) due to the fluctuating velocity field (the turbulent transport of \(\phi\)), and plays a similar role to the Reynolds stress term in the Reynolds equations. 







\subsubsection{Mean Pressure Poisson Equation}
For incompressible flow, pressure satisfies a Pressure-Poisson equation, the mean of which is:

\beqa
-\frac{1}{\rho}\frac{\partial^2 \la\la P\ra + P'\ra}{\partial x_i^2}=&\la\frac{\partial(\la V_i\ra+V_i')}{\partial x_j}\frac{\partial(\la V_j\ra+V_j')}{\partial x_i}\ra\\
-\frac{1}{\rho}\frac{\partial^2 \la P\ra}{\partial x_i^2}=&\la\frac{\partial\la V_i\ra}{\partial x_j}\frac{\partial\la V_j\ra}{\partial x_i}+\frac{\partial \la V_i\ra}{\partial x_j}\frac{\partial V_j'}{\partial x_i}+\frac{\partial \la V_j\ra}{\partial x_i}\frac{\partial V_i'}{\partial x_j}+\frac{\partial V_j'}{\partial x_i}\frac{\partial V_i'}{\partial x_j}\ra\\
-\frac{1}{\rho}\frac{\partial^2\la P\ra}{\partial x_i^2}=&\frac{\partial\la V_i\ra}{\partial x_j}\frac{\partial\la V_j\ra}{\partial x_i}+\frac{\partial \la V_j'V_i'\ra}{\partial x_i\partial x_j}\\
\eeqa

The mean rate of strain \(\la e_{ij}\ra\) and mean rate of rotation \(\la\xi_{ij}\ra\) are:

\beq
\la e_{ij}\ra=\frac{1}{2}\left(\frac{\partial\la V_i\ra}{\partial x_j}+\frac{\partial\la V_j\ra}{\partial x_i}\right)
\eeq 

\beq
\la \xi_{ij}\ra=\frac{1}{2}\left(\frac{\partial\la V_i\ra}{\partial x_j}-\frac{\partial\la V_j\ra}{\partial x_i}\right)
\eeq 

From the above, the Pressure-Poisson equation can equivalently be stated as:

% exercise 4.3
\beq
-\frac{1}{\rho}\frac{\partial^2\la P\ra}{\partial x_i^2}=\la e_{ij}\ra^2-\la \xi_{ij}\ra^2+\frac{\partial \la V_j'V_i'\ra}{\partial x_i\partial x_j}
\eeq




\subsubsection{Reynolds Stresses}

As can be seen from the form of the mean equations, the Reynolds stresses are essential for the development of turbulence - if the Reynolds stresses were zero, then the mean flow equations would be identical in form to the Navier-Stokes equations, and hence the mean velocity field would be identical to the actual velocity field, which is clearly not the case for turbulent flows. To show why the Reynolds stresses are indeed stresses, rewrite the average momentum equation as:

\beqa
\label{eq:RewrittenMom}
\frac{\partial \la V_i\ra}{\partial t}+\frac{\partial(\la V_i\ra\la V_j\ra)}{\partial x_j}=&-\frac{\partial\la V_i'V_j'\ra}{\partial x_j}-\frac{1}{\rho}\frac{\partial \la P\ra}{\partial x_i}+\nu\frac{\partial^2 \la V_i\ra}{\partial x_j\partial x_j}\\
\rho\frac{\partial \la V_i\ra}{\partial t}+\rho\frac{\partial(\la V_i\ra\la V_j\ra)}{\partial x_j}=&\frac{\partial}{\partial x_j}\left\lbrack\mu\left(\frac{\partial\la V_i\ra}{\partial x_j}+\frac{\partial\la V_j\ra}{\partial x_i}\right)-\la P\ra\delta_{ij}-\rho\la V_i'V_j'\ra\right\rbrack\\
\eeqa

where the stresses have all been written in a form that is consistent with the form of the Cauchy identity, where the viscous stress term would implicitly be simpler since we have assumed incompressibility (but we leave it in this form to be explicit). The square brackets represent the sum of three stresses - the viscous stress, the isotropic stress from the mean pressure field, and the Reynolds stress that arises from the fluctuating velocity field. To obtain units of stress, \(\la V_i'V_j'\ra\) should be multiplied by density, though often either form is referred to as a stress. Viscous stress arises due to momentum transfer at the molecular level. Similarly, Reynolds stress arises from momentum transfer due to the fluctuating velocity field. For an arbitrary control volume, the momentum flux into that volume is:

\beq
\textrm{momentum flux}=-\int_{\partial\Omega}\rho\vv{V}\vv{V}\cdot\hat{n}dS
\eeq

where the integral is negative because the normal of the surface is defined to be pointing outwards. Applying the divergence rule and taking the mean:

\beq
\la\textrm{momentum flux}\ra_i=-\int_{\Omega}\rho\frac{\partial}{\partial x_j}\left(\la V_i\ra\la V_j\ra+\la V_i'V_j'\ra\right)dV
\eeq

where the RHS can be seen to be identical to the flux of momentum into the control volume that also appears in Eq. \eqref{eq:AveNS}. So, the Reynolds stress in the Reynolds equations arises due to the mean momentum flux due to the fluctuating velocity on the boundary. So, the presence of turbulence increases the total momentum flux into a volume since the fluctuating velocity components contribute to this momentum flux - this is why turbulence produces very good mixing. 

The Reynolds stresses are components of a symmetric, second-order tensor. The diagonal components are normal stresses, while off-diagonal components are shear stresses. In the principal axes of the Reynolds stress tensor, the shear stresses are zero, while the normal stresses are non-negative eigenvalues. In extreme circumstances, one of these eigenvalues may be zero. The distinction between normal and shear stresses depends on the choice of coordinate system, but you can make a definitive statement about isotropic and anisotropic components of the Reynolds stress tensor. The isotropic stress component \(i_{ij}\) is equal to one third of the trace of the Reynolds stress tensor, since this represents isotropic expansion, where the factor of \(1/3\) cancels \(\delta_{ii}\): 

\beq
i_{ij} = \frac{1}{3}\la V_i'V_i'\ra\delta_{ij}
\eeq

The Reynolds stress tensor is the sum of the isotropic part \(i_{ij}\) and the anisotropic part \(a_{ij}\):

\beqa
a_{ij}=&\la V_i'V_j'\ra-\frac{1}{3}\la V_i'V_i'\ra\delta_{ij}\\
=& \la V_i'V_j'\ra-\frac{2}{3}k\delta_{ij}\\
\eeqa

where \(k\) is the turbulent kinetic energy defined in Eq. \eqref{eq:turbenergy}. Plugging in this expansion for \(\la V_i'V_j'\ra\) into Eq. \eqref{eq:RewrittenMom} shows that only the anisotropic component of the Reynolds stress is effective in transporting momentum, since the isotropic component could be absorbed into a modified pressure term:

\beqa
\rho\frac{\partial \la V_i\ra}{\partial t}+\rho\frac{\partial(\la V_i\ra\la V_j\ra)}{\partial x_j}=&\frac{\partial}{\partial x_j}\left\lbrack\mu\left(\frac{\partial\la V_i\ra}{\partial x_j}+\frac{\partial\la V_j\ra}{\partial x_i}\right)-\la P\ra\delta_{ij}-\rho \left(a_{ij}+\frac{2}{3}k\delta_{ij}\right)\right\rbrack\\
=&\frac{\partial}{\partial x_j}\left\lbrack\mu\left(\frac{\partial\la V_i\ra}{\partial x_j}+\frac{\partial\la V_j\ra}{\partial x_i}\right)-\left(\la P\ra+\frac{2}{3}k\right)\delta_{ij}-\rho a_{ij}\right\rbrack
\eeqa

This is very similar to the Navier-Stokes equations, where only the anisotropic component \(2\mu e_{ij}+\nabla\cdot\vv{V}\delta_{ij}\) contributes to the stress, and the isotropic component is bundled into the pressure term (because it is defined to be the pressure itself). 




\subsubsection{Turbulent Kinetic Energy}

The turbulent kinetic energy \(k\) is defined as the kinetic energy per unit mass associated with the fluctuating velocity field, and is equal to half the trace of the Reynolds stress tensor:

\beq
\label{eq:turbenergy}
k\equiv\frac{1}{2}\la V_iV_i\ra
\eeq

The total kinetic energy \(E\) of the flow is:

\beqa
E=&\frac{1}{2}\vv{V}\cdot\vv{V}\\
=& \frac{1}{2}\left(\la\vv{V}\ra\cdot\la\vv{V}\ra+2\vv{V}'\la\vv{V}\ra+V'V'\right)
\eeqa

The mean of the total kinetic energy is simply the sum of the kinetic energy of the mean flow and the turbulent kinetic energy. 

\beq
\la E\ra=\frac{1}{2}\la\vv{V}\ra\cdot\la\vv{V}\ra+k
\eeq

The turbulent kinetic energy contributes to the \textit{isotropic} portion of the Reynolds stress tensor, but from experimental evidence, the anisotropic portion of the Reynolds stress tensor scales with the turbulent kinetic energy. From the Cauchy-Schwartz inequality, the magnitude of a shear stress component is always less than half the trace of the Reynolds stress tensor. 

\beq
|\la V_i'V_j'\ra|\ \leq k
\eeq





\subsubsubsection{Symmetries of the Reynolds Stress Tensor}
Often, the flow geometry can be used to conclude that certain components of the Reynolds stress are zero. When a flow is independent of the \(x_3\) coordinate, such as for axisymmetric flows that are independent of \(\theta\), statistics are therefore also independent of that coordinate. Hence, the derivative of the PDF of velocity \(f\) with respect to that coordinate will be zero:

\beq
\frac{\partial f}{\partial x_3}=0
\eeq

and \(f\) will also be invariant with respect to reflections of that axis:

\beq
f(V_1,V_2,V_3; x_1,x_2,x_3,t)=f(V_1,V_2,-V_3;x_1,x_2,-x_3,t)
\eeq

For the above equation, when \(x_3=0\), you can conclude that \(\la V_3\ra=-\la V_3\ra=0\). By similar logic, \(\la V_1V_3\ra=\la V_2V_3\ra=0\) (though \(\la V_3V_3\ra\neq0\) because the negative sign will cancel). Then, due to the fact that the flow is statistically invariant with respect to \(x_3\), these conditions apply not just at \(x_3=0\), but throughout the entire flow field. So, for statistically two-dimensional flows such as this, where the flow is statistically invariant with respect to the \(x_3\) axis, the Reynolds stress tensor simplifies to:

\beq
\la V_iV_j\ra=\begin{bmatrix}\la V_1^2\ra&\la V_1V_2\ra&0\\
\la V_1V_2\ra & \la V_2^2\ra & 0\\
0 & 0 & \la V_3^2\ra\end{bmatrix}
\eeq

A flow can be both independent of one coordinate, and also symmetric about other coordinates. For instance, for flow in a pipe, the flow is symmetric in the \(x_2\) coordinate (\(r\) coordinate). This implies that \(f\) is also symmetric with respect to a flip in the \(x_2\) coordinate:

\beq
f(V_1,V_2,V_3; x_1,x_2,x_3,t)=f(V_1,-V_2,V_3;x_1,-x_2,x_3,t)
\eeq

From this, we can conclude that \(\la V_1V_2\ra\) is an odd function of \(x_2\), while \(\la V_1V_1\ra\) and \(\la V_2V_2\ra\) are even functions of \(x_2\). However, because the flow is not independent of \(x_2\), we cannot conclude anything about these components being zero throughout the entire domain as we could with respect to the \(x_3\) axis. 


\section{Irrotational Motion}
An essential feature of turbulent flows is that they are rotational. If the vorticity is zero, then \(\xi_{ij}=0\) (as well as the product of the mean rate of rotation with velocity). The average is therefore also zero:

\beqa
\label{eq:CorrinKistler}
\la V_i'\left(\frac{\partial V_i'}{\partial x_j}-\frac{\partial V_j'}{\partial x_i}\right)\ra=&0\\
\frac{\partial}{\partial x_j}\left(\frac{1}{2}\la V_i'V_i'\ra\right)-\frac{\partial}{\partial x_i}\la V_i'V_j'\ra=&0\\
\frac{\partial k}{\partial x_j}-\frac{\partial}{\partial x_i}\la V_i'V_j'\ra=&0\\
\eeqa

Eq. \eqref{eq:CorrinKistler}, which has assumed incompressibility in the last term, shows that for irrotational flows, the gradient of the Reynolds stress, which is the form that appears in the momentum equation, has the same effect as the isotropic stress, and hence could be absorbed into a modified pressure term. So, for irrotational flows, the Reynolds stresses have no impact on the mean velocity field. Hence, irrotational flow essentially shows no characteristics of turbulence because the Reynolds stress has no impact on the mean velocity.






\section{Free Shear Flows}
% part (iii) on page 94

Free shear flows are flows in which there are no shear stresses that would normally be imposed by solid walls. Jets, wakes behind solid bodies, and mixing layers between two fluids are common examples of free shear flows. 

\subsection{The Round Jet}
Consider a round jet of initial diameter \(d\) with an initially uniform velocity \(U_J\). This flow will be statistically stationary provided the jet velocity does not change with time. By assuming independence of the \(\theta\) coordinate, this flow is then also axisymmetric. Because \(\frac{\partial f}{\partial\theta}=0\), \(\la u'w'\ra=\la v'w'\ra=\la W\ra=0\), where the velocity has components \(U, V, W\). The flow is entirely determined, assuming negligibly small impact of the particular nozzle shape, by \(Re=U_Jd/\nu\). 

The main velocity occurs in the axial direction, and the centerline velocity \(U_0\) decreases going down the jet. However, because the jet spreads, at any particular \(r/r_{1/2}\), the velocity will be maximum at some intermediate \(x/d\). The jet half-width, or \(r_{1/2}\), is the radius at which the mean axial velocity is half of the centerline velocity. The mean radial velocity is about an order of magnitude smaller than the mean axial velocity. All of the remaining analysis assumes we are in the developed region, which begins around \(x/d=30\). As the jet decays and spreads, the mean velocity profile will change, but \(\la U\ra/U_0(x)\) plotted as a function of \(r/r_{1/2}\) collapses onto a single curve, showing that the velocity profile in a round jet is self-similar. Away from the development region, it is experimentally found that the centerline velocity, normalized by the jet velocity, decreases as \(1/x\). 

\beq
\label{eq:Uo}
\frac{U_0(x)}{U_J}=\frac{B}{(x-x_0)/d}
\eeq

It is also experimentally found that the jet spreads linearly, i.e. the jet half-width increases as \(x\), where \(S\) is the spreading rate. This linear spreading makes sense from the point of view of the conical regions that are typically drawn for jets (as opposed to some type of quadratic spreading). 

\beq
r_{1/2}(x)=S(x-x_0)
\eeq

Experimentally, people have found that the slope \(B\) and spreading rate \(S\) are independent of \(Re\), which is surprising given that the only dimensionless quantity that should govern the flow is the Reynolds number. Jets of all Reynolds numbers will decay and spread at roughly the same rate, but the Reynolds number will still certainly have an impact on the file-scale structure of the flow. Because the velocity decays at a rate independent of \(Re\), then because \(\la U\ra/U_0(x)\) is self-similar, the mean velocity profile is independent of \(Re\). For very low Reynolds number flows, this self-similarity breaks down. 

A similarity solution can be developed for the round jet by selecting a similarity variable for the cross-stream coordinate as:

\beq
\xi=\frac{r}{r_{1/2}}
\eeq

which can equivalently be expressed in terms of the axial coordinate \(x\) by multiplying by the formula above for \(r_{1/2}(x)\):

\beq
\xi=\frac{r}{S(x-x_0)}
\eeq

which inspires the definition of an alternative similarity variable (since a multiplication of a similarity variable by a constant will give another equivalent similarity variable):

\beq
\label{eq:eta}
\eta=\frac{r}{x-x_0}
\eeq

From experimental data that tells us that \(\la U\ra/U_0(x)\) gives a profile that is independent of \(r/r_{1/2}\), we define a self-similar velocity profile as:

\beq
\label{eq:ssV}
f(\eta)=\frac{\la U(x,r)\ra}{U_0(x)}
\eeq

Because \(\la U\ra\) is self-similar, by the continuity equation, \(\la V\ra\) must also be self-similar, but by a different similarity function \(h(\eta)\) such that \(\la V\ra/U_0(x)=h(\eta)\). To show this, begin from the continuity equation in polar coordinates:

\beq
\frac{\partial\la U\ra}{\partial x}+\frac{1}{r}\frac{\partial}{\partial r}(r\la V\ra)=0
\eeq

By the chain rule and from the definition of the self-similar velocity profile in Eq. \eqref{eq:ssV}, \(U_0(x)\) from Eq. \eqref{eq:Uo}, and \(\eta\) from Eq. \eqref{eq:eta}:

\beqa
\frac{\partial\la U\ra}{\partial x}=&f(\eta)\frac{\partial U_0(x)}{\partial x}+U_0(x)\frac{\partial f(\eta)}{\partial\eta}\frac{\partial\eta}{\partial x}\\
\frac{\partial\la U\ra}{\partial x}=&f(\eta)\left(\frac{-U_0(x)}{x}\right)+U_0(x)\frac{\partial f(\eta)}{\partial\eta}\left(\frac{-r}{x^2}\right)\\
\frac{\partial\la U\ra}{\partial x}=&\frac{-U_0(x)}{x}\left\lbrack f(\eta)+\frac{\partial f(\eta)}{\partial\eta}\eta\right\rbrack\\
\frac{\partial\la U\ra}{\partial x}=&\frac{-U_0(x)}{x}\frac{\partial (f(\eta)\eta)}{\partial\eta}\\
\eeqa

Substituting this result into the continuity equation, along with the similarity expression for the lateral velocity, gives a condition for the similarity profiles such that \(\la V\ra\) is self-similar. Plotting the similarity profile for the lateral velocity shows that the velocity is zero at \(\xi=0\), which is to be expected from conservation of mass requirements as you approach the centerline. The lateral velocity must decay to zero far from the jet, so the lateral velocity reaches a maximum around \(\xi=0.7\), and becomes negative beyond roughly the half-width of the jet, indicating that fluid at the jet edges becomes entrained in the jet. By defining the self-similarity function \(f(\eta)\), \(h(\eta)\) can be determined, and this will show that the lateral velocity is roughly two orders of magnitude smaller than the axial velocity. 

\beqa
\frac{-U_0(x)}{x}\frac{\partial (f(\eta)\eta)}{\partial\eta}+\frac{1}{r}\frac{\partial}{\partial r}\left(rh(\eta)U_0(x)\right)=&0\\
-\eta\frac{\partial (f(\eta)\eta)}{\partial\eta}+r\frac{\partial h(\eta)}{\partial \eta}\frac{\partial\eta}{\partial r}+h(\eta)=&0\\
\eta\frac{\partial (f(\eta)\eta)}{\partial\eta}=&\frac{\partial (h(\eta)\eta)}{\partial \eta}\\
\eeqa

Like the centerline velocity, the square root of the \(\la U'U'\ra\) Reynolds stress also decays as \(1/x\). Due to this observation, you might also expect, like the axial and lateral velocities, the Reynolds stresses normalized by the centerline velocity to be self-similar. On the centerline of the jet, the square root of the axial normal Reynolds stress is about 25\% of the mean. The Reynolds stresses exhibit significant anisotropy even in this simple round jet. As expected, the normal Reynolds stress along the axis is the largest component, while the shear components are the smallest. Because the shear components are odd functions of \(r\), the shear component is zero at \(r=0\). By normalizing the shear stresses by the turbulent kinetic energy, we see from experimental data that the shear stresses are roughly one third of the turbulent kinetic energy, though the shear stresses drop to zero at the centerline of the jet. All components of the Reynolds stress decay to zero far from the jet.

The derivative of the axial velocity with respect to \(r\) is always negative because the velocity is largest at the centerline and decays moving to greater \(r\). From the definition of the orientation of shear stress, the shear stress will be positive if \(\partial\la U\ra/\partial r<0\). Hence, for the round jet, the shear stress is always positive, which gives rise to a positive turbulent viscosity. Because the mean velocities and the Reynolds stresses are self-similar, this turbulent viscosity is also self-similar. Because the shear stresses are odd functions of \(r\), as is \(\partial\la U\ra/\partial r\), the turbulent viscosity is an even function of \(r\), and is roughly uniform in the center of the jet, but decreases at the edge of the jet. 

By neglecting the viscous effects in the \(r\)-direction turbulent boundary layer equation, Eq. \eqref{eq:BLEx}, such that it is only valid far from the boundary layer, you can show that the mean momentum flow rate is conserved, and is independent of \(x\). Because the momentum flowrate involves a term proportional to \(r_{1/2}U_0(x)\), this product cannot be a function of \(x\), which further explains why a jet spreads and decays linearly. Linear spreading and decay is a consequence of self-similarity. To solve these boundary layer equations, we have three unknowns - \(\la U\ra, \la V\ra\), and \(\la U'V'\ra\), but if we can pick a value for the turbulent viscosity, then we can use the turbulent viscosity model in Eq. \eqref{eq:turbvisc} to provide a closure relationship. By neglecting axial derivatives, the turbulent viscosity model for incompressible flow gives:

\beq
\la U'V'\ra=-\nu_T\frac{\partial\la U\ra}{\partial r}
\eeq

such that the \(z\)-direction momentum equation becomes:

\beq
\la U\ra\frac{\partial \la U\ra}{\partial z}+\la V\ra\frac{\partial \la U\ra}{\partial r}=\frac{(\nu+\nu_T)}{r}\frac{\partial}{\partial r}\left(r\frac{\partial\la U\ra}{\partial r}\right)
\eeq

For high Reynolds number flows, the molecular viscosity is often neglected, such that only the turbulent viscosity is used. If we assume the turbulent viscosity to be uniform, and neglect molecular viscosity, then the above equation is identical to the laminar boundary layer equation, but with averaged velocities replacing instantaneous velocities. Schlichting was the first to obtain the similarity solution for the uniform turbulent viscosity round jet, which gives good comparison with experimental results except at the edges of the jet where the turbulent viscosity decays to zero. The mean velocity profile in a turbulent round jet will be the same profile as that in a laminar jet with Reynolds number \(Re_T=U_0(x)r_{1/2}(x)/\nu_T\approx35\).  



\subsection{The Plane Jet}
From self-similarity, \(y_{1/2}\) increases linearly, but the centerline velocity now decays as \(1/\sqrt{x}\). 

\subsection{The Mixing Layer}
Mixing layers can also be shown to be self-similar when the velocity profiles are scaled relative to the absolute and relative velocities of the two regions. The mixing layer spreads linearly, though the flow will spread preferentially into the low-speed stream. 

\subsection{The Plane Wake}

The wake behind a cylinder cannot be exactly self-similar because the ratio of the difference in velocities to the absolute velocity evolves in time, but in the asymptotic region far behind the wake, the flow becomes self-similar in the asymptote. The wake spreads as \(\sqrt{x}\), while the difference between the free-stream velocity and the velocity scales as \(1/\sqrt{x}\). 

\subsection{The Axisymmetric Wake} 
The wake behind a sphere, like that behind a cylinder, cannot be self-similar except in the limit of the velocity difference relative to the free-stream velocity tending to zero (i.e. far behind the body). 

\subsection{Homogeneous Turbulence}
In all of the above free shear flows, production of turbulent kinetic energy exceeds dissipation, but because the flow is statistically stationary, the turbulent kinetic energy cannot increase in time. This causes turbulent kinetic energy to be transported away from the centerline of the flows. This directional transport is by definition inhomogeneous. Homogeneous turbulence, on the other hand, has statistically homogeneous fluctuating velocities and pressures. After a development region, homogeneous turbulent shear flows become self-similar so that statistics become independent of time. 

For homogeneous flows, 






\subsection{Boundary Layer Equations}
For the round jet, because the lateral velocity is about two orders of magnitude smaller than the axial velocity, we can assume that axial gradients are of much smaller magnitude than lateral gradients. The assumption of negligible gradients in certain directions of the flow leads to boundary layer equations, which are simplified versions of the governing equations. 


\subsubsection{Statistically 2-D and Stationary}
We can derive these equations for a stationary, statistically 2-D flow with main flow direction \(x\) and velocity components \(U, V, W\) such that \(\la W\ra=0\). The continuity equation becomes:

\beq
\frac{\partial\la U\ra}{\partial x}+\frac{\partial\la V\ra}{\partial y}=0
\eeq

And the two momentum equations become:

\beq
\frac{\partial}{\partial x}\left(\la U\ra\la U\ra+\underbrace{\la U'U'\ra}_{\textrm{neglect}}\right)+\frac{\partial}{\partial y}\left(\la U\ra\la V\ra+\la U'V'\ra\right)+\frac{1}{\rho}\frac{\partial \la P\ra}{\partial x}-\nu\left(\underbrace{\frac{\partial^2 \la U\ra}{\partial x^2}}_{\textrm{neglect}}+\frac{\partial^2 \la U\ra}{\partial y^2}\right)=0
\eeq

\beq
\frac{\partial}{\partial x}\left(\la V\ra\la U\ra+\underbrace{\la V'U'\ra}_{\textrm{neglect}}\right)+\frac{\partial}{\partial y}\left(\la V\ra\la V\ra+\la V'V'\ra\right)+\frac{1}{\rho}\frac{\partial \la P\ra}{\partial y}-\nu\left(\underbrace{\frac{\partial^2 \la V\ra}{\partial x^2}}_{\textrm{neglect}}+\frac{\partial^2 \la V\ra}{\partial y^2}\right)=0
\eeq

where diffusion along the main flow direction is neglected because it scales as \(\delta^2/c^2\), where \(\delta\) is the thickness of the boundary layer and \(c\) the characteristic length, where the boundary layer approximation relies on the assumption that \(\delta\ll c\). Then, we further assume that the axial derivatives of the Reynolds stresses are negligible relative to the derivatives in the lateral direction. It should be noted that, while this is consistent with the approximations made for the laminar boundary layer equations, for certain flows the Reynolds stresses can be of order 10\% of the other terms in the equation, and hence this approximation is not always valid. If we further neglect advection of momentum in the lateral direction and assume that there is also negligible diffusion in the lateral direction (additional assumptions above the typical boundary layer equation formulation), then the lateral momentum equation dramatically simplifies to:

\beq
\frac{1}{\rho}\frac{\partial\la P\ra}{\partial y}+\frac{\la V'V'\ra}{\partial y}=0
\eeq

Assuming the free stream far from the boundary layer has pressure \(P_{\infty}\) and is either quiescent or laminar such that there are zero Reynolds stresses, the above equation can be integrated to give the pressure:

\beq
\frac{\la P\ra}{\rho}=\frac{\la P_{\infty}\ra}{\rho}-\la V'V'\ra
\eeq

Differentiating with respect to \(x\):

\beq
\frac{1}{\rho}\frac{\partial \la P\ra}{\partial x}=\frac{1}{\rho}\frac{\partial \la P_{\infty}\ra}{\partial x}-\underbrace{\frac{\partial \la V'V'\ra}{\partial x}}_{\textrm{neglect}}
\eeq

where the Reynolds stress in the axial direction is again neglected. Inserting the above into the axial momentum boundary layer equation gives:

\beq
\frac{\partial}{\partial x}\left(\la U\ra\la U\ra\right)+\frac{\partial}{\partial y}\left(\la U\ra\la V\ra+\la U'V'\ra\right)+\frac{1}{\rho}\frac{\partial \la P_{\infty}\ra}{\partial x}-\nu\frac{\partial^2 \la U\ra}{\partial y^2}=0
\eeq

When the far-field flow is quiescent or uniform, then \(\partial\la P_{\infty}\ra/\partial x=0\). 



\subsubsection{Statistically Axisymmetric and Stationary}
For stationary, statistically axisymmetric flows, \(\la W\ra=\la V'W'\ra=\la U'W'\ra=0\), where \(U\) represents flow along the \(z\) coordinate, \(V\) flow along the \(r\) coordinate, and \(W\) flow along the \(\theta\) coordinate, and similar boundary layer equations can be derived beginning from the mean flow equations in cylindrical coordinates. The continuity equation becomes:

\beq
\frac{1}{r}\frac{\partial (r\la V\ra)}{\partial r}+\frac{\partial \la U\ra}{\partial z}=0
\eeq

And the momentum equations become:

\beqa
\la U\ra\frac{\partial \la U\ra}{\partial z}+\la V\ra\frac{\partial \la U\ra}{\partial r}=\frac{-1}{\rho}\frac{\partial \la P\ra}{\partial z}-\underbrace{\frac{\partial \la U'U'\ra}{\partial z}}_{\textrm{neglect}}-\frac{1}{r}\frac{\partial (r\la V'U'\ra)}{\partial r}+\nu\left(\underbrace{\frac{\partial^2\la U\ra}{\partial z^2}}_{\textrm{neglect}}+\frac{1}{r}\frac{\partial}{\partial r}\left(r\frac{\partial\la U\ra}{\partial r}\right)\right)
\eeqa

\beqa
\la U\ra\frac{\partial \la V\ra}{\partial z}+\la V\ra\frac{\partial\la V\ra}{\partial r}=\frac{-1}{\rho}\frac{\partial \la P\ra}{\partial r}+\nu\left(\underbrace{\frac{\partial^2\la V\ra}{\partial z^2}}_{\textrm{neglect}}+\frac{1}{r}\frac{\partial}{\partial r}\left(r\frac{\partial\la V\ra}{\partial r}\right)-\frac{\la V\ra}{r^2}\right)+\frac{\la W'W'\ra}{r}-\underbrace{\frac{\partial \la U'V'\ra}{\partial z}}_{\textrm{neglect}}-\frac{1}{r}\frac{\partial(r\la V'V'\ra}{\partial r}\\
\eeqa

where again we neglect diffusion along the axial direction for both the mean and fluctuating flow. If we further neglect all advection and diffusion in the lateral direction, the lateral momentum equation simplifies and can be integrated in \(r\) to give the mean pressure distribution:

\beqa
\frac{1}{\rho}\frac{\partial \la P\ra}{\partial r}=\frac{\la W'W'\ra}{r}-\frac{\partial(\la V'V'\ra}{\partial r}-\frac{\la V'V'\ra}{r}\\
\frac{\la P_{\infty}\ra}{\rho}=\frac{\la P\ra}{\rho}+\la V'V'\ra+\int_{r}^{\infty}\frac{\la W'W'\ra - \la V'V'\ra}{r'}dr'\\
\eeqa

By taking the derivative of the above with respect to \(z\), and then again assuming that derivatives are negligible along the axial direction relative to those in the lateral direction, then a relationship for the axial pressure gradient can be determined:

\beq
\frac{1}{\rho}\frac{\partial\la P_{\infty}\ra}{\partial x}=\frac{1}{\rho}\frac{\partial\la P\ra}{\partial x}
\eeq

Substituting this into the \(x\)-direction momentum equation gives:

\beq
\la U\ra\frac{\partial \la U\ra}{\partial z}+\la V\ra\frac{\partial \la U\ra}{\partial r}=\frac{-1}{\rho}\frac{\partial \la P_{\infty}\ra}{\partial z}-\frac{1}{r}\frac{\partial (r\la V'U'\ra)}{\partial r}+\frac{\nu}{r}\frac{\partial}{\partial r}\left(r\frac{\partial\la U\ra}{\partial r}\right)
\eeq

And for a quiescent free stream, the gradient of the far-stream pressure is zero, giving the \(x\)-direction turbulent boundary layer equation:

\beq
\label{eq:BLEx}
\la U\ra\frac{\partial \la U\ra}{\partial z}+\la V\ra\frac{\partial \la U\ra}{\partial r}=-\frac{1}{r}\frac{\partial (r\la V'U'\ra)}{\partial r}+\frac{\nu}{r}\frac{\partial}{\partial r}\left(r\frac{\partial\la U\ra}{\partial r}\right)
\eeq









\section{Self-Similarity}
Self-similarity is a very important concept in the study of fluids because it is often one of the only ways that  analytic solutions can be determined for certain classes of flows. Consider an arbitrary quantity \(Q\) that depends on two variables, \(x\) and \(y\). We can attempt to scale the quantity and \textit{one} of its dependent variables by parameters that only depend on the \textit{other} dependent variable:

\beq
\xi=\frac{y}{\delta(x)}
\eeq

\beq
\hat{Q}(\xi,x)=\frac{Q(x,y)}{Q_0(x)}
\eeq

If \(\hat{Q}(\xi,x)\) is independent of \(x\), then \(Q(x,y)\) is self-similar, and its variation with respect to two variables \(x\) and \(y\) can be reduced to variation with respect to a single variable \(\xi\) that is some function of \(x\) and \(y\). In this case, the PDE for \(Q\) in terms of \(x\) and \(y\) is reduced to an ODE in terms of \(Q_0(x), \delta(x), \hat{Q}(\xi)\). Based on the starting equations for applying self-similarity arguments, self-similar behavior may only be observed over some range in \(x\) and \(y\). 

\section{Boundary Layer Theory}
If boundary layers are assumed to be much thinner than the characteristic flow dimension and boundary layers do not become separated such that the viscous region does not enter the main flow, the core flow can be treated as inviscid (far from no-slip boundaries), and various corrections can be made in the vicinity of walls. Inviscid calculations generally predict the actual pressure fairly well (which is important for accurate drag and life calculations for aerospace applications. 

At high \(Re\), the boundary layer thickness \(\delta\) is of the order \(\delta/L\approx\sqrt{Re}\). From boundary layer theory, if the velocity component perpendicular to the surface is assumed small, every term in the momentum equation perpendicular to the wall cancels except the pressure gradient term, giving:

\beq
\frac{\partial P}{\partial n}\approx 0
\eeq

In other words, the pressure across the boundary layer is nearly constant. This permits the combination of viscid-invsicid calculations, where an inviscid calculation is used to compute pressure. The thickness of the boundary layer is initially unknown, but to a good first approximation, the entire domain can be considered inviscid. Then, the pressure at some initial guess for the boundary layer thickness can be used to solve a viscous problem in the boundary layer (matching the velocities at the interface with the inviscid core). Iteration can be performed until convergence on the thickness of the boundary layer.

\section{The Modeling of Turbulence}

It is very difficult to develop tractable models for turbulent flows for several reasons:

\begin{itemize}
\item The flows are time-dependent, three-dimensional, and random
\item The largest turbulent motions are on the order of the characteristic flow scale of the geometry, and hence boundary condition effects cannot be neglected
\item There is a large range in timescales and lengthscales - the Kolmogorov timescale decreases as \(Re^{-1/2}\), while the Kolmogorov lengthscale decreases as \(Re^{-3/4}\). In wall-bounded flows, the most energetic motions, which are responsible for peak turbulence production, scale with the viscous lengthscale, which is very small and decreases as \(Re^{-0.8}\). 
\item The nonlinear convection term and the pressure gradient term cause great numerical difficulties - when the pressure gradient term is expressed in terms of the Pressure Poisson equation, it is both nonlinear and non-local. 
\end{itemize}

Most turbulence models consists of sets of partial differential equations, and in some cases also algebraic equations. While turbulence \textit{simulations} solve for time-dependent fields that represent one realization of a turbulent flow, turbulence \textit{models} solve for the mean quantities. DNS and LES are two examples of turbulence simulations. In DNS, you solve for the actual velocity field for one realization of the flow, and because you need to have a mesh that can resolve all of the timescales and lengthscales, DNS is very computationally expensive. Computational cost scales as \(Re^3\) for 3-D simulations, and hence DNS is restricted to low Reynolds number flows, and hence is of less practical importance than other simulations or models. In LES, you solve for a filtered velocity field that is representative of the larger-scale turbulent motions, with a model for the impact of the smaller-scale motions on the larger-scale motions included in the system of equations (though the smaller scales are not directly modeled). 

The RANS equations solves the Reynolds equations to determine the mean fields. The Reynolds stresses are either solved for using models such as turbulent viscosity, where that turbulent viscosity is determined from an algebraic relationship as in the mixing-length model or from turbulence quantities such as \(k\) and \(\epsilon\) with their own transport equations. In Reynolds-stress models, transport equations are solved for the Reynolds stresses, eliminating the needed for the turbulent viscosity models. Finally, because the mean velocity and the Reynolds stresses are the first and second moments of the Eulerian PDF of velocity, PDF methods solve a model transport equation for a PDF such as \(f\). 

Models can be distinguished by whether or not they are \textit{complete}. A complete model gives results that depend solely on material properties and initial and boundary conditions, while incomplete models contain closure relationships that depend on the nature of the flow. For example, with the mixing length model, the selection of the mixing length depends on the \textit{type} of flow, assumed to be known by the modeler. For some models, the cost scales with the Reynolds number, but for others, the cost is relatively independent of the Reynolds number. Many models, such as those that are based on velocity spectra or two-point correlations, are only applicable to homogeneous turbulent flows, and hence they are not discussed in this document. 

%\cite{hirsch}
Turbulence is a global instability that arises due to the nonlinear convective term in the momentum equation. Once turbulent, all flow quantities show statistical fluctuations. These fluctuations can be on the order of 10\% in common situations, and much higher in separated flow regions.

\subsection{Large Eddy Simulation}
LES is a combination of DNS for the largest-scale turbulent motions, with models for the smaller scale motions. The LES equations are obtained by averaging the Navier-Stokes equations over only the high energy range (small wavelength). 

\subsection{Reynolds-Averaged Navier-Stokes}
The RANS equations compute the time-averaged turbulent flow by averaging all statistical turbulent fluctuations out of the equations. Note that this does not mean the governing equations are completely time-independent; provided the averaging time interval is smaller than the non-turbulent time scales characterizing the system, only the turbulent time scales are averaged out. The RANS equations consist of a large subset of different turbulence models that differ in how they model the Reynolds stress terms that arise from the averaged momentum equation. This section discusses several of the common RANS formulations.

\subsubsection{The Mixing Length Model}
The mixing length model can be applied to statistically two-dimensional boundary-layer flows. Solve the boundary layer equations for \(\la U\ra\) and \(\la V\ra\), and determine the Reynolds shear stress and the turbulent viscosity from the model equations:

\beq
\la U'V'\ra=-\nu_T\frac{\partial\la U\ra}{\partial y}
\eeq

\beq
\nu_T=l_m(x,y)^2\biggr\rvert\frac{\partial\la U\ra}{\partial y}\biggr\rvert
\eeq

This model requires the mixing length \(l_m\) to be defined, and hence this is not a complete model, since the appropriate specification of the mixing length is flow-dependent. The cost of this simulation is relatively independent of the Reynolds number. 

\subsubsection{Thin Shear Layer Approximation}
For flows with little separation or back-flow such that the flow is primarily one-directional, viscous and turbulent diffusion can be neglected in the mainstream direction, which reduces the number of Reynolds stress tensor entries. This is also supported by the fact that the mesh is generally much more refined perpendicular to the main flow direction to capture wall effects, so the neglected terms would have been computed with lower accuracy anyways. %\cite{hirsch} (chapter 2)

The thins shear layer approximation is similar to the boundary layer approximation, except that the momentum equation is retained in the direction perpendicular to the main flow direction such that the transition from viscous to inviscid flow at the edge of the boundary layer is still an integral part of the calculation (as opposed to performing an inviscid-viscid iterative method). The thin shear layer approximation was developed during a time when aggressive computing cost reductions had to be made, and modern day it is not really motivated by any simplicity, since it still requires RANS models for the mainstream directions.

\subsection{Gradient-Diffusion Methods}
This model assumes that the turbulent transport of the passive scalar \(\phi\), \(\la \vv{V}'\phi'\ra\), occurs down the mean scalar gradient, in the direction of \(-\nabla\la\phi\ra\) proportional to the turbulent diffusivity \(\Gamma_T\). This is equivalent to Fourier's law of heat conduction or Fick's law.

\beq
\la\vv{V}'\phi'\ra=-\Gamma_T\nabla\la\phi\ra
\eeq

Because this form will lead to two diffusion terms in mean equation, the two terms can be condensed into one by defining an effective diffusivity \(\Gamma_{eff}=\Gamma+\Gamma_T\). Hence, this simply model assumes that the turbulent transport of \(\phi\) occurs as if \(\phi\) were being diffused with higher diffusivity. In the Reynolds momentum equation, the gradient-diffusion approximation for incompressible flow, assuming constant \(\Gamma_T\) leads to:

\beq
\frac{\partial \la V_i\ra}{\partial t}+\frac{\partial}{\partial x_j}\left(\la V_i\ra\la V_j\ra+\la V_i'V_j'\ra\right)+\frac{1}{\rho}\frac{\partial \la P\ra}{\partial x_i}-\nu_{eff}\frac{\partial^2 \la V_i\ra}{\partial x_j\partial x_j}=0
\eeq

This model assumes that \(\la \vv{V}'\phi'\ra\) is aligned with \(\la\nabla\la\phi\ra\), which is not the case even in simple turbulent flows. 


\subsection{Turbulent Viscosity Methods}
Turbulent viscosity methods, also called eddy viscosity methods, are similar to gradient-diffusion methods in that both result in \(\nu\) simply being increased by a constant, except that gradient-diffusion method assume that constant represents proportionality to the mean gradient via Fourier's law, while turbulent viscosity methods assume that constant represents equivalence between the deviatoric Reynolds stress and the deviatoric stress tensor in the Navier-Stokes equation. The turbulent viscosity method is based on the relationship for the deviatoric stress tensor in the Navier-Stokes equation, which from the constitutive relationship for \(\sigma_{ij}\), is assumed proportional to \(e_{ij}\):

\beq
\sigma_{ij}=-P\delta_{ij}+c_{ijkl}e_{ij}
\eeq

The deviatoric portion of the Reynolds stress \(a_{ij}\) is assumed proportional to the \textit{mean} of the deviatoric portion of the Navier Stokes stress tensor:

\beqa
a_{ij}=&-2\nu_T\la\left(e_{ij}-\frac{1}{3}\nabla\cdot\vv{V}\delta_{ij}\right)\ra\\
\rho\la V_i'V_j'\ra-\frac{2}{3}\rho k\delta_{ij}=&-2\mu_T\la\left(e_{ij}-\frac{1}{3}\nabla\cdot\vv{V}\delta_{ij}\right)\ra\\
\eeqa

where \(\mu_T/\rho\) is the turbulent viscosity. Then, inserting this into the Reynolds momentum equation:

\beq
\label{eq:turbvisc}
\rho\frac{\partial \la V_i\ra}{\partial t}+\rho\frac{\partial(\la V_i\ra\la V_j\ra)}{\partial x_j}=\frac{\partial}{\partial x_j}\left\lbrack(\mu+\mu_T)\left(\frac{\partial\la V_i\ra}{\partial x_j}+\frac{\partial\la V_j\ra}{\partial x_i}\right)-\left(\la P\ra+\frac{2}{3}\rho k\right)\delta_{ij}\right\rbrack
\eeq

This model assumes that \(a_{ij}\) is aligned with \(\la e_{ij}\ra\), which is not the case even in simple turbulent flows. At high \(Re\), both \(\nu_T\) and \(\Gamma_T\) scale with the flow velocity and length scale, independent of the actual molecular properties of the flow:

\beq
\frac{\nu_T}{\nu}\approx\frac{VD}{\nu}
\eeq

and hence both \(\nu_T/\nu\) and \(\Gamma_T/\Gamma\) increase linearly with Reynolds number, so molecular transport becomes increasingly negligible as the Reynolds number increases. The turbulent Prandtl number \(Pr_T\) is defined as:

\beq
Pr_T=\frac{\nu_T}{\Gamma_T}
\eeq

and is often near unity for simply turbulent flows. 



\subsection{Direct Numerical Simulation}
DNS involves solving the Navier-Stokes equations (\textit{not} the Reynolds equations), resolving all of the scales of motion. Each simulation produces a single realization of the flow. Because the cost of DNS scales are \(Re^3\), this approach is infeasible for large \(Re\), which unfortunately is the most relevant application area. Provided all the details of initial conditions, boundary conditions, and geometry are specified accurately, in principle the Navier-Stokes equations can be used to simulate turbulent flows. This is known as DNS. 

\subsubsection{Homogeneous Turbulence}
For homogeneous turbulence, pseudo-spectral methods are preferred for numerical simulation because of their superior accuracy. 


\section{The Euler Equations}
The classical Euler equations are fully hyperbolic. The fluxes are purely convective, which results in behavior very similar to wave propagation due to the passive nature of convective fluxes - fluxes in directions other than the velocity vector cannot be supported. The Euler equations permit discontinuous solutions such as vortex sheets, contact discontinuities, and shock waves, but only when solving the integral form of the conservation equations. %\cite{hirsch} (chapter 2).

\section{Finite Difference Methods}
This section discusses finite difference methods and their use in solving the Navier-Stokes equations. This section is organized to first present a discussion of FD methods and their numerical properties. A method is {\it convergent} if the error in our numerical solution goes to zero as \(\Delta t\rightarrow0\) at some fixed time \(t_n\):

\beq
\lim_{\Delta t\rightarrow0}U^n=u(t_n)
\eeq

The convergence of a method in general depends on the specific problem to which it is applied and the starting values (required for higher-order multistep methods) used. As \(\Delta t\rightarrow0\), all of these starting values should converge to the initial condition, so we can place the following condition on the \(r\) starting values:

\beq
\lim_{\Delta t\rightarrow0}U^n=u(0)\hspace{1cm} \text{for\ } n=0, 1, \cdots, r-1
\eeq

Therefore, a method is {\it convergent} if applying the method to any ODE of the form \(u'=f(u,t)\), with \(f(u,t)\) Lipschitz continuous in \(u\), with starting values that converge to the initial condition as \(\Delta t\rightarrow0\), results in the error in the numerical solution tending to zero as \(\Delta t\rightarrow0\). Convergence requires both consistency and stability. Definitions for consistency and stability will be given in the sections that follow.

\subsection{Linear Multistep Methods}
Linear Multistep Methods (LMMs) are perhaps the easiest-to-understand of the FD formulas - the derivative at a point is a linear combination of the derivatives and values at nearby points:

\beq
\label{eq:LMM}
\sum_{i=0}^{r}\alpha_iU^{n+1}=\Delta t\sum_{i=0}^{r}\beta_if(U^{n+1},t_{n+1})
\eeq

\begin{tcolorbox}[breakable]
Due to the limitless possibilities suggested by the above formula, names are given to several of the more common variations of LMMs. The Adams methods compute the derivative using only two adjacent point evaluations, but any number of derivative evaluations:

\beq
U^{n+r}-U^{n+r-1}=\Delta t\sum_{i=0}^{r}\beta_if(U^{n+i},t_{n+i})
\eeq

If the method is made explicit such that \(\beta_r=0\), then the remaining \(r\) coefficients (an \(r\)-step method) can be selected such that the method is \(r\)-th order accurate. These explicit methods are often referred to as the Adams-Bashforth methods. The Adams-Bashforth methods can be derived by using Taylor series to expand each of the terms that appear in the above equation to form a system of \(r\) equations for \(r\) unknown coefficients such that the highest possible truncation error terms are zero. Alternatively, the above equation can be interpreted as a quadrature rule for integrating \(f(u(t))\) between the two point evaluations:

\beqa
u(t_{n+r})=&\ u(t_{n+r-1})+\int_{t_{n+r-1}}^{t_{n+r}}u'(t)dt\\
=&\ u(t_{n+r-1})+\int_{t_{n+r-1}}^{t_{n+r}}f(u(t))dt\\
\approx&\ \Delta t\sum_{i=0}^{r-1}\beta_if(U^{n+i},t_{n+i})
\eeqa

Quadrature rules can be derived by interpolating the integrand in a polynomial through \(r\) points (order \(r-1\) polynomial) and performing analytic integration. The backward Euler method is the 1-step Adams-Bashforth method.\newline

If the LMM is made implicit such that \(\beta_r\neq0\), then by analogue of the Taylor series expansion method, there is one greater degree of freedom (\(\beta_r\)), so one higher order of truncation term can be eliminated, giving an order \(r+1\) method. This family of implicit LMMs is known as the Adams-Moulton methods. The trapezoidal method is the 1-step Adams-Moulton method.\newline

If instead of writing the derivative in terms of two {\it adjacent} points like the Adams-Bashforth methods, using points separated by one gridpoint gives Nystrom methods:

\beq
U^{n+r}-U^{n+r-2}=\Delta t\sum_{i=0}^r\beta_if(U^{n+r},t_{n+r})
\eeq

The midpoint method, or leapfrog method, is a two-step explicit Nystrom method, while Simpson's method is a two-step implicit Nystrom method.
\end{tcolorbox}

\subsubsection{Consistency}

The local truncation error is defined as the error made in the approximation of the derivative, and can be evaluated by plugging in the true solution to the FD approximation. The LTE is a function of the time step:

\begin{subequations}
\label{eq:ConsistencyLMM}
\begin{eqnarray}
\tau(t_{n+r})&=&\frac{1}{\Delta t}\sum_{i=0}^r\alpha_iu(t_{n+i})-\sum_{i=0}^r\beta_iu'(t_{n+i})\\
&=&\frac{1}{\Delta t}\left(\sum_{i=0}^r\alpha_i\right)u(t_n)+\left(\sum_{i=0}^r(i\alpha_i-\beta_i)\right)u'(t_n)+\Delta t\left(\sum_{i=0}^r\left\lbrack\frac{1}{2}i^2\alpha_i-i\beta_i\right\rbrack\right)u''(t_n)+\cdots\hspace{1cm}
\end{eqnarray}
\end{subequations}

By expressing \(u(t_{n+i})=u(t_n)+u'(t_n)i\Delta t+u''(t_n)(i\Delta t)^2/2+\cdots\) and \(u'(t_{n+i})=u'(t_n)+u''(t_n)i\Delta t+u'''(t_n)(i\Delta t)^2/2+\cdots\), Eq. \eqref{eq:ConsistencyLMM}b arises. For a consistent method, we require that the LTE go to zero as the mesh size goes to zero. Two terms above do not scale as \(\Delta t\) to a positive power, so to be a consistent method, we require that:

\beq
\sum_{i=0}^r\alpha_i=0
\eeq

\beq
\sum_{i=0}^r(i\alpha_i-\beta_i)=0
\eeq

Hence, note that consistency depends only on the numerical method itself, and not on the equation to which is it applied. Having derived the conditions for consistency, the conditions for stability can be given in terms of the characteristic polynomials \(\rho\) and \(\sigma\) of an LMM, defined as:

\beq
\rho(\xi)=\sum_{i=0}^r\alpha_i\xi^i
\eeq

\beq
\sigma(\xi)=\sum_{i=0}^r\beta_i\xi^i
\eeq

\begin{tcolorbox}[breakable]
If \(\xi=1\), then:

\beq
\rho(1)=\sum_{i=0}^r\alpha_i
\eeq

\beq
\rho'(1)=\sum_{i=0}^ri\alpha_j
\eeq

\beq
\sigma(1)=\sum_{i=0}^r\beta_i
\eeq

Therefore, the characteristic polynomials can be used to concisely express the consistency requirement for LMMs as \(\rho(1)=0\) and \(\rho'(1)=\sigma(1)\).
\end{tcolorbox}

\subsubsection{Stability}
Stability will be illustrated through the solution to a simple model scalar problem:

\beq
\label{eq:ModelP}
u'(t)=\lambda u(t)+g(t)
\eeq

A method is stable if the global error is bounded (independently of \(\Delta t\)) in terms of the sums of all of the individual one-step truncation errors. 

\subsubsubsection{Zero Stability}
If the method is consistent such that the truncation error goes to zero as \(\Delta t\rightarrow0\), the method is zero stable (stability under the conditions of \(\Delta t\rightarrow0\)). This is the minimum stability requirement that {\it must} be satisfied by a FD method. Note, however, that zero stability does not give any sort of guarantee for stability for a finite \(\Delta t\), because the two consistency requirements derived from the previous section still leave ``wiggle room'' in the method that can make the method unstable. Zero stability is often assessed by setting \(\lambda=g(t)=0\) in Eq. \eqref{eq:ModelP}; a method is zero stable if the eigenvalue \(\lambda=0\) is within its range of stability. Zero-stability for a general LMM in Eq. \eqref{eq:LMM} can be determined by analyzing the solutions to \(u'(t)=0\):

\beq
\sum_{i=0}^r\alpha_iU^{n+i}=0
\eeq

We will hypothesize a solution of the form \(U^n=\xi^n\), where the \(n\) represents an exponent on \(\xi\), but a time index on \(U\). Plugging in this solution, and dividing by \(\xi^n\), gives:

\beq
\sum_{i=0}^r\alpha_i\xi^i=0
\eeq

which we can recognize as the characteristic polynomial \(\rho\). So, if \(\xi\) is a root of \(\rho(\xi)\), then our hypothesis of the form of the solution is correct. Therefore, the solution to a generic linear difference equation can be written as a linear combination (with coefficients \(c\)) of the \(r\) linearly independent solutions \(\xi_j^n\), to give the solution at step \(n\):

\beq
U^n=c_0\xi_0^n+c_1\xi_1^n+c_2\xi_2^n+\cdots +c_r\xi_r^n
\eeq

If any of the roots are repeated, then the solutions will not all be linearly independent, so an additional form of a valid solution is \(n\xi^n\) (and \(n^2\xi^2\) and \(n^3\xi^3\), etc. for even more repeated roots). The coefficients of the linear combination are determined based on the starting data, permitting the determination of a general solution for \(U^n\) in terms of the starting values and the roots of \(\rho(\xi)\). If any of the roots of \(\rho(\xi)\) are greater than unity in magnitude, then any errors in the initial starting values grow with some power of \(n\), and the method will not be convergent, even if those initial errors are proportional to \(\Delta t\). In addition to this requirement, it is also required that there are no repeated roots of unity magnitude, because then the additional linearly independent solution(s) \(n\xi^n\) (required to avoid a singular system when solving for the coefficients \(c\)) would not tend to zero as \(\Delta t\rightarrow0\).

An \(r\)-step LMM is zero-stable if the roots of \(\rho(\xi)\) all have magnitude less than or equal unity, and there are no repeated roots of unity magnitude. Note that this condition specifically refers to zero stability because we refer to the roots of the characteristic polynomial \(\rho(\xi)\) that arises from the general equation \(u'(t)=0\). This condition is also referred to as the ``root condition.'' 

If a FD method has a solution that does not satisfy the root condition, then either the solution does not converge at all (if the roots have magnitude greater than unity, then the error \(E^n\equiv U^n-u(t_n)=U^n\) (for \(U^0=0\)) increases exponentially with \(n\)); or the solution converges on a different equation (such as the case when the error increases as \(n\), rather than as \(n^p\) with \(p>1\)). From our consistency requirement for LMMs that \(\rho(1)=0\), it is clear that all consistent LMMs have at least one root equal to unity, also called the ``principal root.'' Therefore, all consistent one-step LMMs are automatically zero stable, and thus convergent in the limit of \(\Delta t\rightarrow0\).

While zero stability only specifies convergence for problems of the form \(u'(t)=0\), it can be shown that zero stability is the only type of stability that is required to converge an LMM for any initial value problem \(u'(t)=f(u,t)\), where \(u\) is only a function of time.



\end{flushleft}
\end{document}
